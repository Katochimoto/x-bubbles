{"version":3,"sources":["webpack:///x-bubbles-compact.min.js","webpack:///webpack/bootstrap cf39d06a4cd24c1e24e5","webpack:///./index.js","webpack:///./context.js","webpack:///./core/drag.js","webpack:///./core/drag/native.js","webpack:///./core/select.js","webpack:///./core/bubble.js","webpack:///./core/text.js","webpack:///./core/bubbleset.js","webpack:///./core/utils.js","webpack:///../~/raf/index.js","webpack:///../~/performance-now/lib/performance-now.js","webpack:///../~/process/browser.js","webpack:///./core/events.js","webpack:///./polyfills/CustomEventCommon.js","webpack:///./core/constant.js","webpack:///./core/drag/common.js","webpack:///./core/drag/bubbles.png","webpack:///./core/drag/mouse.js","webpack:///external {\"var\":\"Modernizr\",\"root\":\"modernizr\",\"commonjs2\":\"modernizr\",\"commonjs\":\"modernizr\",\"amd\":\"modernizr\"}","webpack:///./core/editor.js","webpack:///./core/cursor.js","webpack:///./core/editor/copy.js"],"names":["XBubbles","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","optionsPrepare","options","name","OPTIONS","_OPTIONS$name","_slicedToArray","type","def","OPTIONS_PREPARE","initEditor","node","editor","Object","defineProperty","configurable","value","init","destroyEditor","destroy","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","length","err","Array","isArray","TypeError","_typeof","obj","constructor","prototype","_extends","assign","target","arguments","source","key","hasOwnProperty","context","drag","bubble","bubbleset","begining","bubbleCopy","bubbleDeformation","bubbleFormation","classBubble","draggable","disableControls","ending","separator","create","HTMLDivElement","createdCallback","this","attachedCallback","bubbling","detachedCallback","_options","keys","reduce","result","item","dataset","items","get","getBubbles","setContent","data","addBubble","bubbleText","removeBubble","nodeBubble","editBubble","document","registerElement","extends","funk","Function","bool","noop","eval","native","mouse","_require","canUseDrag","nodeSet","onDragstart","event","stopPropagation","closestNodeSet","closestNodeBubble","preventDefault","selection","getSelection","removeAllRanges","currentDragSet","classList","add","CLS","DRAGSTART","select","dataTransfer","effectAllowed","setData","list","setDragImage","getDragImage","DRAG_IMG_WIDTH","onDrop","forEach","appendChild","setTimeout","onDropSuccess","onDragover","dropEffect","onDragenter","DROPZONE","onDragleave","remove","onDragend","events","_require2","EVENTS","dragend","dragenter","dragleave","dragover","dragstart","drop","on","off","range","isBubbleNode","set","parentNode","uniq","clear","headList","lastList","startRangeSelect","fromNode","toNode","position","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","setSelected","nextSibling","all","slice","querySelectorAll","PATH_NOT_SELECTED","querySelector","PATH_SELECTED","has","Boolean","head","last","removeAttribute","toggleUniq","isSelected","removeSelected","hasAttribute","setAttribute","nodeType","ELEMENT_NODE","edit","rangeParams","dataText","text","textClean","innerText","startOffset","endOffset","textFake","createZws","textNode","createTextNode","fireEdit","replaceChild","insertBefore","createRange","setStart","setEnd","addRange","wrap","createElement","escape","classes","String","trim","split","len","ranges","getBubbleRanges","nodes","toString","deleteContents","textParts","map","trimIterator","filter","nonEmptyIterator","parts","str","concat","parseFragmentByEnding","parseFragmentByBeginning","fragment","createDocumentFragment","textPart","insertNode","fireInput","fireChange","children","childNodes","setEndBefore","setStartBefore","setEndAfter","reg","lastIndex","loop","exec","substring","res","index","text2bubble","currentTextRange","replace","pointNode","focusNode","TEXT_NODE","anchorNode","startNode","endNode","previousSibling","rangeCount","anchor","getRangeAt","surroundContents","collapse","replaceString","nodeValue","arrowLeft","extend","_selectionCorrect","selectionCorrect","revert","isCollapsed","isNativeExtend","offset","checkZws","arrowRight","_selectionCorrect2","html2text","DOMContainer","implementation","createHTMLDocument","body","selectAll","hasBubbles","TEXT_ZWS","REG_ZWS","test","REG_REPLACE_NON_PRINTABLE","anchorOffset","focusOffset","Math","min","max","lastBubble","headBubble","findBubbleLeft","DOCUMENT_POSITION_FOLLOWING","getAttribute","prevBubble","nextBubble","unescapeHtmlChar","chr","HTML_UNESCAPES","escapeHtmlChar","HTML_ESCAPES","raf","&","<",">","\"","'","`","&amp;","&lt;","&gt;","&quot;","&#39;","&#96;","REG_ESCAPED_HTML","REG_UNESCAPED_HTML","REG_HAS_ESCAPED_HTML","RegExp","REG_HAS_UNESCAPED_HTML","REG_IE","throttle","callback","animationCallback","apply","unescape","navigator","userAgent","global","now","root","window","vendors","suffix","caf","queue","frameDuration","_now","cp","cancelled","e","round","handle","fn","cancel","polyfill","requestAnimationFrame","cancelAnimationFrame","process","getNanoSeconds","hrtime","loadTime","performance","hr","Date","getTime","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","queueIndex","drainQueue","timeout","run","Item","array","nextTick","args","title","browser","env","argv","version","versions","addListener","once","removeListener","removeAllListeners","emit","binding","cwd","chdir","dir","umask","_defineProperty","enumerable","writable","scrollX","html","documentElement","scrollLeft","clientLeft","scrollY","scrollTop","clientTop","dispatch","element","params","dispatchEvent","Custom","oneCallback","eventName","_callback","removeEventListener","CustomEventCommon","keyCode","charCode","metaKey","ctrlKey","pageX","clientX","pageY","clientY","one","addEventListener","prevent","cancelBubble","returnValue","stopImmediatePropagation","CustomEvent","doc","protoEvent","Event","issetCustomEvent","createEvent","immediatePropagationStopped","bubbles","cancelable","evt","initCustomEvent","detail","initEvent","KEY","a","Backspace","Bottom","Cmd","Comma","Enter","Esc","Left","Right","Semicolon","Space","Tab","Top","EV","BUBBLE_EDIT","BUBBLE_INPUT","CHANGE","DRAGEND","DRAGENTER","DRAGLEAVE","DROP","dragImage","Image","src","fromNodeSet","toNodeSet","focus","onMousedown","__drag__","onMouseup","bind","onMousemove","utils","onScroll","nodeOffsetX","offsetX","nodeOffsetY","offsetY","x","y","currentMoveSet","currentDragElement","dragSet","removeChild","_","moveElement","cloneNode","style","cssText","Modernizr","csstransforms3d","transform","csstransforms","top","left","onBlur","nodeEditor","currentTarget","_lockCopy","onFocus","cursor","restore","onKeyup","code","isPrintableChar","onKeypress","onKeydown","enable","backSpace","copy","shiftKey","begin","normalize","onPaste","clipboardData","getData","contentType","kind","some","getAsString","dataPaste","onDblclick","onClick","firstChild","contains","textRange","editText","_bubbleValue","blur","click","dblclick","keydown","keypress","keyup","mscontrolselect","paste","resize","resizestart","basis","restoreBasis","fakeText","hasChildNodes","lastNode","isEqualNode","removeNode","ownerDocument","defaultView"],"mappings":"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","file":"x-bubbles-compact.min.js","sourcesContent":["var XBubbles =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar context = __webpack_require__(1);\n\tvar drag = __webpack_require__(2);\n\tvar editor = __webpack_require__(19);\n\tvar bubble = __webpack_require__(5);\n\tvar bubbleset = __webpack_require__(7);\n\t\n\tvar OPTIONS = {\n\t    begining: ['noop', null],\n\t    bubbleCopy: ['funk', function () {}],\n\t    bubbleDeformation: ['funk', function () {}],\n\t    bubbleFormation: ['funk', function () {}],\n\t    classBubble: ['noop', 'bubble'],\n\t    draggable: ['bool', true],\n\t    disableControls: ['bool', false],\n\t    ending: ['noop', null], // /\\@ya\\.ru/g;\n\t    separator: ['noop', /[,;]/]\n\t};\n\t\n\tvar XBubbles = Object.create(HTMLDivElement.prototype, {\n\t    createdCallback: {\n\t        value: function value() {\n\t            initEditor(this);\n\t        }\n\t    },\n\t\n\t    attachedCallback: {\n\t        value: function value() {\n\t            initEditor(this);\n\t            drag.init(this);\n\t            bubble.bubbling(this);\n\t        }\n\t    },\n\t\n\t    detachedCallback: {\n\t        value: function value() {\n\t            drag.destroy(this);\n\t            destroyEditor(this);\n\t        }\n\t    },\n\t\n\t    /*\n\t    attributeChangedCallback: {\n\t        value: function (name, prevValue, value) {}\n\t    },\n\t    */\n\t\n\t    options: {\n\t        value: function value(name, _value) {\n\t            if (!this._options) {\n\t                this._options = _extends({}, Object.keys(OPTIONS).reduce(function (result, item) {\n\t                    result[item] = undefined;\n\t                    return result;\n\t                }, {}), this.dataset);\n\t\n\t                optionsPrepare(this._options);\n\t            }\n\t\n\t            if (typeof _value !== 'undefined') {\n\t                this._options[name] = _value;\n\t                optionsPrepare(this._options);\n\t            } else {\n\t                return this._options[name];\n\t            }\n\t        }\n\t    },\n\t\n\t    items: {\n\t        get: function get() {\n\t            return bubbleset.getBubbles(this);\n\t        }\n\t    },\n\t\n\t    setContent: {\n\t        value: function value(data) {\n\t            return this.editor.setContent(data);\n\t        }\n\t    },\n\t\n\t    addBubble: {\n\t        value: function value(bubbleText, data) {\n\t            return this.editor.addBubble(bubbleText, data);\n\t        }\n\t    },\n\t\n\t    removeBubble: {\n\t        value: function value(nodeBubble) {\n\t            return this.editor.removeBubble(nodeBubble);\n\t        }\n\t    },\n\t\n\t    editBubble: {\n\t        value: function value(nodeBubble) {\n\t            return this.editor.editBubble(nodeBubble);\n\t        }\n\t    }\n\t});\n\t\n\tmodule.exports = context.document.registerElement('x-bubbles', {\n\t    extends: 'div',\n\t    prototype: XBubbles\n\t});\n\t\n\tvar OPTIONS_PREPARE = {\n\t    funk: function funk(value) {\n\t        var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n\t        switch (type) {\n\t            case 'string':\n\t                return new Function('context', 'return context.' + value + ';')(context);\n\t\n\t            case 'function':\n\t                return value;\n\t        }\n\t    },\n\t    bool: function bool(value) {\n\t        var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n\t        switch (type) {\n\t            case 'string':\n\t                return value === 'true' || value === 'on';\n\t\n\t            case 'boolean':\n\t                return value;\n\t        }\n\t    },\n\t    noop: function noop(value) {\n\t        return value;\n\t    }\n\t};\n\t\n\tfunction optionsPrepare(options) {\n\t    for (var name in OPTIONS) {\n\t        var _OPTIONS$name = _slicedToArray(OPTIONS[name], 2);\n\t\n\t        var type = _OPTIONS$name[0];\n\t        var def = _OPTIONS$name[1];\n\t\n\t        options[name] = OPTIONS_PREPARE[type](options[name]);\n\t        if (typeof options[name] === 'undefined') {\n\t            options[name] = def;\n\t        }\n\t    }\n\t}\n\t\n\tfunction initEditor(node) {\n\t    if (!node.editor) {\n\t        Object.defineProperty(node, 'editor', {\n\t            configurable: true,\n\t            value: editor.init(node)\n\t        });\n\t    }\n\t}\n\t\n\tfunction destroyEditor(node) {\n\t    if (node.editor) {\n\t        editor.destroy(node);\n\t        delete node.editor;\n\t    }\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function () {\n\t    /* eslint no-eval: 0 */\n\t    return this || (1, eval)('this');\n\t}();\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar native = __webpack_require__(3);\n\tvar mouse = __webpack_require__(17);\n\t\n\tvar _require = __webpack_require__(8);\n\t\n\tvar canUseDrag = _require.canUseDrag;\n\t\n\t\n\texports.init = function (nodeSet) {\n\t    if (canUseDrag()) {\n\t        return native.init(nodeSet);\n\t    }\n\t\n\t    return mouse.init(nodeSet);\n\t};\n\t\n\texports.destroy = function (nodeSet) {\n\t    if (canUseDrag()) {\n\t        return native.destroy(nodeSet);\n\t    }\n\t\n\t    return mouse.destroy(nodeSet);\n\t};\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\tvar select = __webpack_require__(4);\n\tvar bubbleset = __webpack_require__(7);\n\tvar events = __webpack_require__(12);\n\t\n\tvar _require = __webpack_require__(14);\n\t\n\tvar CLS = _require.CLS;\n\t\n\tvar _require2 = __webpack_require__(15);\n\t\n\tvar getDragImage = _require2.getDragImage;\n\tvar onDropSuccess = _require2.onDropSuccess;\n\tvar DRAG_IMG_WIDTH = _require2.DRAG_IMG_WIDTH;\n\t\n\t\n\tvar EVENTS = {\n\t    dragend: onDragend,\n\t    dragenter: onDragenter,\n\t    dragleave: onDragleave,\n\t    dragover: onDragover,\n\t    dragstart: onDragstart,\n\t    drop: onDrop\n\t};\n\t\n\tvar currentDragSet = null;\n\t\n\texports.init = function (nodeSet) {\n\t    events.on(nodeSet, EVENTS);\n\t};\n\t\n\texports.destroy = function (nodeSet) {\n\t    events.off(nodeSet, EVENTS);\n\t};\n\t\n\tfunction onDragstart(event) {\n\t    event.stopPropagation();\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (!nodeSet || !nodeBubble) {\n\t        event.preventDefault();\n\t        return;\n\t    }\n\t\n\t    var selection = context.getSelection();\n\t    selection && selection.removeAllRanges();\n\t\n\t    currentDragSet = nodeSet;\n\t    nodeSet.classList.add(CLS.DRAGSTART);\n\t    select.add(nodeBubble);\n\t\n\t    event.dataTransfer.effectAllowed = 'move';\n\t    event.dataTransfer.setData('text/plain', '');\n\t\n\t    var list = select.get(currentDragSet);\n\t    if (list.length > 1) {\n\t        event.dataTransfer.setDragImage(getDragImage(), DRAG_IMG_WIDTH, DRAG_IMG_WIDTH);\n\t    }\n\t}\n\t\n\tfunction onDrop(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet || nodeSet === currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var list = select.get(currentDragSet);\n\t\n\t    if (list.length) {\n\t        list.forEach(function (item) {\n\t            return nodeSet.appendChild(item);\n\t        });\n\t        context.setTimeout(onDropSuccess, 0, currentDragSet, nodeSet);\n\t    }\n\t}\n\t\n\tfunction onDragover(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    event.dataTransfer.dropEffect = 'move';\n\t}\n\t\n\tfunction onDragenter(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    if (nodeSet && nodeSet !== currentDragSet) {\n\t        nodeSet.classList.add(CLS.DROPZONE);\n\t    }\n\t}\n\t\n\tfunction onDragleave(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    if (nodeSet && nodeSet !== currentDragSet) {\n\t        nodeSet.classList.remove(CLS.DROPZONE);\n\t    }\n\t}\n\t\n\tfunction onDragend(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    currentDragSet.classList.remove(CLS.DRAGSTART);\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (nodeSet && nodeSet !== currentDragSet) {\n\t        nodeSet.classList.remove(CLS.DROPZONE);\n\t    }\n\t\n\t    currentDragSet = null;\n\t}\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\tvar bubble = __webpack_require__(5);\n\tvar bubbleset = __webpack_require__(7);\n\t\n\tvar slice = Array.prototype.slice;\n\tvar PATH_SELECTED = '[bubble][selected]';\n\tvar PATH_NOT_SELECTED = '[bubble]:not([selected])';\n\t\n\texports.all = all;\n\texports.add = add;\n\texports.clear = clear;\n\texports.get = get;\n\texports.uniq = uniq;\n\texports.head = head;\n\texports.last = last;\n\texports.has = has;\n\texports.range = range;\n\texports.toggleUniq = toggleUniq;\n\t\n\tfunction range(node) {\n\t    if (!bubble.isBubbleNode(node)) {\n\t        return;\n\t    }\n\t\n\t    var set = node.parentNode;\n\t    var list = get(set);\n\t\n\t    if (!list.length) {\n\t        uniq(node);\n\t        return;\n\t    }\n\t\n\t    clear(set);\n\t\n\t    var headList = list[0];\n\t    var lastList = list[list.length - 1];\n\t\n\t    if (headList === lastList || !set.startRangeSelect) {\n\t        set.startRangeSelect = headList;\n\t    }\n\t\n\t    var fromNode = void 0;\n\t    var toNode = void 0;\n\t    var position = node.compareDocumentPosition(set.startRangeSelect);\n\t\n\t    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n\t        fromNode = set.startRangeSelect;\n\t        toNode = node;\n\t    } else {\n\t        fromNode = node;\n\t        toNode = set.startRangeSelect;\n\t    }\n\t\n\t    if (fromNode && toNode) {\n\t        var item = fromNode;\n\t\n\t        while (item) {\n\t            if (!setSelected(item)) {\n\t                break;\n\t            }\n\t\n\t            if (item === toNode) {\n\t                break;\n\t            }\n\t\n\t            item = item.nextSibling;\n\t        }\n\t\n\t        bubble.bubbling(set);\n\t    }\n\t}\n\t\n\tfunction all(nodeSet) {\n\t    slice.call(nodeSet.querySelectorAll(PATH_NOT_SELECTED)).forEach(function (item) {\n\t        return setSelected(item);\n\t    });\n\t    nodeSet.startRangeSelect = nodeSet.querySelector(PATH_SELECTED);\n\t\n\t    bubble.bubbling(nodeSet);\n\t\n\t    var selection = context.getSelection();\n\t    selection && selection.removeAllRanges();\n\t}\n\t\n\tfunction has(nodeSet) {\n\t    return Boolean(nodeSet.querySelector(PATH_SELECTED));\n\t}\n\t\n\tfunction head(set) {\n\t    return get(set)[0];\n\t}\n\t\n\tfunction last(set) {\n\t    var list = get(set);\n\t    return list[list.length - 1];\n\t}\n\t\n\tfunction get(nodeSet) {\n\t    return slice.call(nodeSet.querySelectorAll(PATH_SELECTED));\n\t}\n\t\n\tfunction clear(nodeSet) {\n\t    get(nodeSet).forEach(function (item) {\n\t        return item.removeAttribute('selected');\n\t    });\n\t}\n\t\n\tfunction add(node) {\n\t    if (setSelected(node)) {\n\t        var nodeSet = bubbleset.closestNodeSet(node);\n\t\n\t        nodeSet.startRangeSelect = node;\n\t        // ???\n\t        bubble.bubbling(nodeSet);\n\t\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction uniq(node) {\n\t    if (!bubble.isBubbleNode(node)) {\n\t        return false;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(node);\n\t    var selection = context.getSelection();\n\t\n\t    selection && selection.removeAllRanges();\n\t    clear(nodeSet);\n\t\n\t    return add(node);\n\t}\n\t\n\tfunction toggleUniq(node) {\n\t    if (isSelected(node)) {\n\t        var nodeSet = bubbleset.closestNodeSet(node);\n\t\n\t        if (get(nodeSet).length === 1) {\n\t            return removeSelected(node);\n\t        }\n\t    }\n\t\n\t    return uniq(node);\n\t}\n\t\n\tfunction isSelected(node) {\n\t    return bubble.isBubbleNode(node) && node.hasAttribute('selected') || false;\n\t}\n\t\n\tfunction setSelected(node) {\n\t    if (bubble.isBubbleNode(node)) {\n\t        node.setAttribute('selected', '');\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction removeSelected(node) {\n\t    if (bubble.isBubbleNode(node)) {\n\t        node.removeAttribute('selected');\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\tvar text = __webpack_require__(6);\n\t\n\tvar _require = __webpack_require__(8);\n\t\n\tvar escape = _require.escape;\n\tvar canUseDrag = _require.canUseDrag;\n\t\n\t\n\texports.isBubbleNode = isBubbleNode;\n\texports.bubbling = bubbling;\n\texports.create = create;\n\texports.edit = edit;\n\t\n\tfunction isBubbleNode(node) {\n\t    if (!node || node.nodeType !== Node.ELEMENT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    return node.hasAttribute('bubble');\n\t}\n\t\n\tfunction edit(nodeSet, nodeBubble) {\n\t    if (nodeBubble.hasAttribute('readonly')) {\n\t        return false;\n\t    }\n\t\n\t    var selection = context.getSelection();\n\t\n\t    if (!selection) {\n\t        return false;\n\t    }\n\t\n\t    var bubbleDeformation = nodeSet.options('bubbleDeformation');\n\t    var rangeParams = bubbleDeformation(nodeBubble);\n\t\n\t    if (!rangeParams) {\n\t        var dataText = text.textClean(nodeBubble.innerText);\n\t\n\t        rangeParams = {\n\t            text: dataText,\n\t            startOffset: 0,\n\t            endOffset: dataText.length\n\t        };\n\t    }\n\t\n\t    var textFake = text.createZws();\n\t    var textNode = context.document.createTextNode(rangeParams.text);\n\t\n\t    nodeSet.fireEdit(nodeBubble);\n\t    nodeSet.replaceChild(textNode, nodeBubble);\n\t    nodeSet.insertBefore(textFake, textNode);\n\t\n\t    var range = context.document.createRange();\n\t    range.setStart(textNode, rangeParams.startOffset);\n\t    range.setEnd(textNode, rangeParams.endOffset);\n\t\n\t    selection.removeAllRanges();\n\t    selection.addRange(range);\n\t    return true;\n\t}\n\t\n\tfunction create(nodeSet, dataText) {\n\t    var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t    dataText = text.textClean(dataText);\n\t\n\t    if (!dataText) {\n\t        return;\n\t    }\n\t\n\t    var bubbleFormation = nodeSet.options('bubbleFormation');\n\t    var classBubble = nodeSet.options('classBubble');\n\t    var draggable = canUseDrag() && nodeSet.options('draggable');\n\t    var wrap = context.document.createElement('span');\n\t\n\t    wrap.innerText = dataText;\n\t\n\t    if (draggable) {\n\t        wrap.setAttribute('draggable', 'true');\n\t    }\n\t\n\t    for (var key in data) {\n\t        if (data[key]) {\n\t            wrap.setAttribute('data-' + key, escape(data[key]));\n\t        }\n\t    }\n\t\n\t    bubbleFormation(wrap);\n\t\n\t    if (classBubble) {\n\t        var classes = String(classBubble).trim().split(/\\s+/);\n\t        var len = classes.length;\n\t\n\t        while (len--) {\n\t            wrap.classList.add(classes[len]);\n\t        }\n\t    }\n\t\n\t    wrap.setAttribute('bubble', '');\n\t    wrap.setAttribute('contenteditable', 'false');\n\t\n\t    return wrap;\n\t}\n\t\n\tfunction bubbling(nodeSet) {\n\t    var separator = nodeSet.options('separator');\n\t    var ending = nodeSet.options('ending');\n\t    var begining = nodeSet.options('begining');\n\t    var ranges = getBubbleRanges(nodeSet);\n\t    var nodes = [];\n\t\n\t    ranges.forEach(function (range) {\n\t        var dataText = text.textClean(range.toString());\n\t\n\t        if (!dataText) {\n\t            range.deleteContents();\n\t            return;\n\t        }\n\t\n\t        var textParts = [dataText];\n\t\n\t        if (separator) {\n\t            textParts = dataText.split(separator).map(trimIterator).filter(nonEmptyIterator);\n\t        }\n\t\n\t        if (ending) {\n\t            textParts = textParts.reduce(function (parts, str) {\n\t                return parts.concat(parseFragmentByEnding(str, ending));\n\t            }, []).map(trimIterator).filter(nonEmptyIterator);\n\t        } else if (begining) {\n\t            textParts = textParts.reduce(function (parts, str) {\n\t                return parts.concat(parseFragmentByBeginning(str, begining));\n\t            }, []).map(trimIterator).filter(nonEmptyIterator);\n\t        }\n\t\n\t        if (!textParts.length) {\n\t            range.deleteContents();\n\t        }\n\t\n\t        var fragment = context.document.createDocumentFragment();\n\t\n\t        textParts.forEach(function (textPart) {\n\t            var nodeBubble = create(nodeSet, textPart);\n\t            if (nodeBubble) {\n\t                fragment.appendChild(nodeBubble);\n\t                nodes.push(nodeBubble);\n\t            }\n\t        });\n\t\n\t        range.deleteContents();\n\t        range.insertNode(fragment);\n\t    });\n\t\n\t    nodeSet.fireInput();\n\t\n\t    if (nodes.length) {\n\t        nodeSet.fireChange();\n\t    }\n\t\n\t    return nodes;\n\t}\n\t\n\tfunction getBubbleRanges(nodeSet) {\n\t    var ranges = [];\n\t    var children = nodeSet.childNodes;\n\t    var range = void 0;\n\t    var node = void 0;\n\t\n\t    for (var i = 0; i < children.length; i++) {\n\t        node = children[i];\n\t\n\t        if (isBubbleNode(node)) {\n\t            if (range) {\n\t                range.setEndBefore(node);\n\t                ranges.push(range);\n\t                range = undefined;\n\t            }\n\t        } else {\n\t            if (!range) {\n\t                range = context.document.createRange();\n\t                range.setStartBefore(node);\n\t            }\n\t        }\n\t    }\n\t\n\t    if (range) {\n\t        range.setEndAfter(node);\n\t        ranges.push(range);\n\t    }\n\t\n\t    return ranges;\n\t}\n\t\n\tfunction trimIterator(str) {\n\t    return str.trim();\n\t}\n\t\n\tfunction nonEmptyIterator(str) {\n\t    return Boolean(str);\n\t}\n\t\n\tfunction parseFragmentByEnding(str, reg) {\n\t    var parts = [];\n\t    var lastIndex = 0;\n\t    var loop = 999;\n\t\n\t    reg.lastIndex = 0;\n\t    while (reg.exec(str) !== null && loop) {\n\t        loop--;\n\t        parts.push(str.substring(lastIndex, reg.lastIndex));\n\t        lastIndex = reg.lastIndex;\n\t    }\n\t\n\t    return parts;\n\t}\n\t\n\tfunction parseFragmentByBeginning(str, reg) {\n\t    var parts = [];\n\t    var res = void 0;\n\t    var index = 0;\n\t    var loop = 999;\n\t\n\t    reg.lastIndex = 0;\n\t    while ((res = reg.exec(str)) !== null && loop) {\n\t        loop--;\n\t        if (index !== res.index) {\n\t            parts.push(str.substring(index, res.index));\n\t            index = res.index;\n\t        }\n\t    }\n\t\n\t    parts.push(str.substring(index, str.length));\n\t    return parts;\n\t}\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\tvar bubble = __webpack_require__(5);\n\tvar bubbleset = __webpack_require__(7);\n\t\n\t/* eslint-disable max-len */\n\tvar REG_REPLACE_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\tvar REG_ZWS = /\\u200B/;\n\tvar TEXT_ZWS = '\\u200B';\n\t\n\texports.arrowRight = arrowRight;\n\texports.arrowLeft = arrowLeft;\n\texports.remove = remove;\n\texports.html2text = html2text;\n\texports.currentTextRange = currentTextRange;\n\texports.text2bubble = text2bubble;\n\texports.replaceString = replaceString;\n\texports.selectAll = selectAll;\n\texports.textClean = textClean;\n\texports.checkZws = checkZws;\n\texports.createZws = createZws;\n\t\n\tfunction text2bubble(nodeSet, nodeBubble, selection) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return false;\n\t    }\n\t\n\t    var range = currentTextRange(selection);\n\t\n\t    if (range && !nodeBubble) {\n\t        nodeBubble = bubble.create(nodeSet, range.toString());\n\t    }\n\t\n\t    if (!nodeBubble) {\n\t        return false;\n\t    }\n\t\n\t    if (range) {\n\t        selection.removeAllRanges();\n\t        selection.addRange(range);\n\t        replace(selection, nodeBubble);\n\t    } else {\n\t        nodeSet.appendChild(nodeBubble);\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction currentTextRange(selection) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return;\n\t    }\n\t\n\t    var pointNode = selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE ? selection.focusNode : selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE ? selection.anchorNode : undefined;\n\t\n\t    if (!pointNode) {\n\t        return;\n\t    }\n\t\n\t    var range = context.document.createRange();\n\t    var startNode = pointNode;\n\t    var endNode = pointNode;\n\t    var item = pointNode;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        startNode = item;\n\t        item = item.previousSibling;\n\t    }\n\t\n\t    item = pointNode;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        endNode = item;\n\t        item = item.nextSibling;\n\t    }\n\t\n\t    range.setStartBefore(startNode);\n\t    range.setEndAfter(endNode);\n\t\n\t    return range;\n\t}\n\t\n\tfunction remove(selection) {\n\t    return replace(selection, createZws());\n\t}\n\t\n\tfunction replace(selection, node) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection || !selection.rangeCount) {\n\t        return false;\n\t    }\n\t\n\t    var anchor = context.document.createElement('span');\n\t    selection.getRangeAt(0).surroundContents(anchor);\n\t    anchor.parentNode.replaceChild(node, anchor);\n\t\n\t    selection.removeAllRanges();\n\t    selection.collapse(node, 0);\n\t\n\t    return true;\n\t}\n\t\n\tfunction replaceString(data, selection) {\n\t    data = textClean(data);\n\t    if (!data) {\n\t        return false;\n\t    }\n\t\n\t    selection = selection || context.getSelection();\n\t    var textNode = context.document.createTextNode(data);\n\t\n\t    if (!replace(selection, textNode)) {\n\t        return false;\n\t    }\n\t\n\t    selection.collapse(textNode, textNode.nodeValue.length);\n\t    return true;\n\t}\n\t\n\tfunction arrowLeft(selection, extend) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection || !selection.anchorNode || selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\t\n\t        return false;\n\t    }\n\t\n\t    var _selectionCorrect = selectionCorrect(selection);\n\t\n\t    var startNode = _selectionCorrect.startNode;\n\t    var endNode = _selectionCorrect.endNode;\n\t    var startOffset = _selectionCorrect.startOffset;\n\t    var endOffset = _selectionCorrect.endOffset;\n\t    var revert = _selectionCorrect.revert;\n\t\n\t\n\t    if (!selection.isCollapsed && !extend) {\n\t        selection.collapse(startNode, startOffset);\n\t        return true;\n\t    }\n\t\n\t    var isNativeExtend = Boolean(selection.extend);\n\t    revert = isNativeExtend ? revert : !revert;\n\t    var node = revert ? startNode : endNode;\n\t    var offset = revert ? startOffset : endOffset;\n\t\n\t    while (node) {\n\t        if (node.nodeType !== Node.TEXT_NODE) {\n\t            return false;\n\t        }\n\t\n\t        if (offset === null) {\n\t            offset = node.nodeValue.length;\n\t        }\n\t\n\t        if (offset - 1 < 0) {\n\t            node = node.previousSibling;\n\t            offset = null;\n\t            continue;\n\t        }\n\t\n\t        var text = node.nodeValue.substring(offset - 1, offset);\n\t\n\t        if (checkZws(text)) {\n\t            offset = offset - 1;\n\t            continue;\n\t        }\n\t\n\t        break;\n\t    }\n\t\n\t    if (!node || offset === null) {\n\t        return false;\n\t    }\n\t\n\t    if (extend) {\n\t        if (isNativeExtend) {\n\t            selection.extend(node, offset - 1);\n\t        } else {\n\t            var range = context.document.createRange();\n\t\n\t            if (revert) {\n\t                range.setStart(node, offset - 1);\n\t                range.setEnd(endNode, endOffset);\n\t            } else {\n\t                range.setStart(startNode, startOffset);\n\t                range.setEnd(node, offset - 1);\n\t            }\n\t\n\t            selection.removeAllRanges();\n\t            selection.addRange(range);\n\t        }\n\t    } else {\n\t        selection.collapse(node, offset - 1);\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction arrowRight(selection, extend) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection || !selection.focusNode || selection.focusNode.nodeType !== Node.TEXT_NODE) {\n\t\n\t        return false;\n\t    }\n\t\n\t    var _selectionCorrect2 = selectionCorrect(selection);\n\t\n\t    var startNode = _selectionCorrect2.startNode;\n\t    var endNode = _selectionCorrect2.endNode;\n\t    var startOffset = _selectionCorrect2.startOffset;\n\t    var endOffset = _selectionCorrect2.endOffset;\n\t    var revert = _selectionCorrect2.revert;\n\t\n\t\n\t    if (!selection.isCollapsed && !extend) {\n\t        selection.collapse(endNode, endOffset);\n\t        return true;\n\t    }\n\t\n\t    var node = revert ? startNode : endNode;\n\t    var offset = revert ? startOffset : endOffset;\n\t\n\t    while (node) {\n\t        if (node.nodeType !== Node.TEXT_NODE) {\n\t            return false;\n\t        }\n\t\n\t        var len = node.nodeValue.length;\n\t\n\t        if (offset + 1 > len) {\n\t            node = node.nextSibling;\n\t            offset = 0;\n\t            continue;\n\t        }\n\t\n\t        var text = node.nodeValue.substring(offset, offset + 1);\n\t\n\t        if (checkZws(text)) {\n\t            offset = offset + 1;\n\t            continue;\n\t        }\n\t\n\t        break;\n\t    }\n\t\n\t    if (!node) {\n\t        return false;\n\t    }\n\t\n\t    if (extend) {\n\t        var isNativeExtend = Boolean(selection.extend);\n\t\n\t        if (isNativeExtend) {\n\t            selection.extend(node, offset + 1);\n\t        } else {\n\t            var range = context.document.createRange();\n\t\n\t            if (revert) {\n\t                range.setStart(node, offset + 1);\n\t                range.setEnd(endNode, endOffset);\n\t            } else {\n\t                range.setStart(startNode, startOffset);\n\t                range.setEnd(node, offset + 1);\n\t            }\n\t\n\t            selection.removeAllRanges();\n\t            selection.addRange(range);\n\t        }\n\t    } else {\n\t        selection.collapse(node, offset + 1);\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction html2text(value) {\n\t    if (!value) {\n\t        return '';\n\t    }\n\t\n\t    var DOMContainer = context.document.implementation.createHTMLDocument('').body;\n\t    DOMContainer.innerText = value;\n\t\n\t    return DOMContainer.innerText.replace(/^[\\u0020\\u00a0]+$/gm, '').replace(/\\n/gm, ' ').trim();\n\t}\n\t\n\tfunction selectAll(selection, nodeSet) {\n\t    selection = selection || context.getSelection();\n\t    var node = selection && selection.anchorNode;\n\t\n\t    if (!node || node.nodeType !== Node.TEXT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    var fromNode = void 0;\n\t    var toNode = void 0;\n\t    var item = node;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        fromNode = item;\n\t        item = item.previousSibling;\n\t    }\n\t\n\t    item = node;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        toNode = item;\n\t        item = item.nextSibling;\n\t    }\n\t\n\t    var hasBubbles = bubbleset.hasBubbles(nodeSet);\n\t    var range = context.document.createRange();\n\t    range.setStartBefore(fromNode);\n\t    range.setEndAfter(toNode);\n\t\n\t    var dataText = textClean(range.toString());\n\t\n\t    if (dataText || !dataText && !hasBubbles) {\n\t        if (!dataText) {\n\t            range.collapse();\n\t        }\n\t\n\t        selection.removeAllRanges();\n\t        selection.addRange(range);\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction createZws() {\n\t    return context.document.createTextNode(TEXT_ZWS);\n\t}\n\t\n\tfunction checkZws(value) {\n\t    return REG_ZWS.test(value);\n\t}\n\t\n\tfunction textClean(value) {\n\t    return String(value || '').trim().replace(REG_REPLACE_NON_PRINTABLE, '');\n\t}\n\t\n\tfunction selectionCorrect(selection) {\n\t    var startNode = selection.anchorNode;\n\t    var endNode = selection.focusNode;\n\t    var startOffset = selection.anchorOffset;\n\t    var endOffset = selection.focusOffset;\n\t    var revert = false;\n\t\n\t    if (startNode === endNode) {\n\t        startOffset = Math.min(selection.anchorOffset, selection.focusOffset);\n\t        endOffset = Math.max(selection.anchorOffset, selection.focusOffset);\n\t        revert = selection.anchorOffset > selection.focusOffset;\n\t    } else {\n\t        var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n\t        if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n\t            startNode = selection.focusNode;\n\t            startOffset = selection.focusOffset;\n\t            endNode = selection.anchorNode;\n\t            endOffset = selection.anchorOffset;\n\t            revert = true;\n\t        }\n\t    }\n\t\n\t    return { startNode: startNode, endNode: endNode, startOffset: startOffset, endOffset: endOffset, revert: revert };\n\t}\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar bubble = __webpack_require__(5);\n\tvar text = __webpack_require__(6);\n\t\n\texports.closestNodeBubble = closestNodeBubble;\n\texports.closestNodeSet = closestNodeSet;\n\texports.findBubbleLeft = findBubbleLeft;\n\texports.getBubbles = getBubbles;\n\texports.hasBubbles = hasBubbles;\n\texports.headBubble = headBubble;\n\texports.lastBubble = lastBubble;\n\texports.nextBubble = nextBubble;\n\texports.prevBubble = prevBubble;\n\t\n\tfunction lastBubble(nodeSet) {\n\t    return nodeSet.querySelector('[bubble]:last-child');\n\t}\n\t\n\tfunction headBubble(nodeSet) {\n\t    return nodeSet.querySelector('[bubble]:first-child');\n\t}\n\t\n\tfunction getBubbles(nodeSet) {\n\t    return Array.prototype.slice.call(nodeSet.querySelectorAll('[bubble]'));\n\t}\n\t\n\tfunction hasBubbles(nodeSet) {\n\t    return Boolean(nodeSet.querySelector('[bubble]'));\n\t}\n\t\n\tfunction findBubbleLeft(selection) {\n\t    if (!selection.focusNode || !selection.anchorNode) {\n\t        return;\n\t    }\n\t\n\t    var node = selection.focusNode.previousSibling;\n\t\n\t    if (selection.anchorNode !== selection.focusNode && selection.anchorNode.compareDocumentPosition(selection.focusNode) & Node.DOCUMENT_POSITION_FOLLOWING) {\n\t        node = selection.anchorNode.previousSibling;\n\t    }\n\t\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        if (node.nodeType === Node.TEXT_NODE && text.textClean(node.nodeValue)) {\n\t            return;\n\t        }\n\t\n\t        node = node.previousSibling;\n\t    }\n\t}\n\t\n\tfunction closestNodeSet(node) {\n\t    while (node) {\n\t        if (node.nodeType === Node.ELEMENT_NODE && node.getAttribute('is') === 'x-bubbles') {\n\t\n\t            return node;\n\t        }\n\t\n\t        node = node.parentNode;\n\t    }\n\t}\n\t\n\tfunction closestNodeBubble(node) {\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.parentNode;\n\t    }\n\t}\n\t\n\tfunction prevBubble(target) {\n\t    var node = target && target.previousSibling;\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.previousSibling;\n\t    }\n\t}\n\t\n\tfunction nextBubble(target) {\n\t    var node = target && target.nextSibling;\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.nextSibling;\n\t    }\n\t}\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar raf = __webpack_require__(9);\n\tvar context = __webpack_require__(1);\n\t\n\t/* eslint quotes: 0 */\n\t\n\tvar HTML_ESCAPES = {\n\t    '&': '&amp;',\n\t    '<': '&lt;',\n\t    '>': '&gt;',\n\t    '\"': '&quot;',\n\t    \"'\": '&#39;',\n\t    '`': '&#96;'\n\t};\n\t\n\tvar HTML_UNESCAPES = {\n\t    '&amp;': '&',\n\t    '&lt;': '<',\n\t    '&gt;': '>',\n\t    '&quot;': '\"',\n\t    '&#39;': \"'\",\n\t    '&#96;': '`'\n\t};\n\t\n\tvar REG_ESCAPED_HTML = /&(?:amp|lt|gt|quot|#39|#96);/g;\n\tvar REG_UNESCAPED_HTML = /[&<>\"'`]/g;\n\tvar REG_HAS_ESCAPED_HTML = RegExp(REG_ESCAPED_HTML.source);\n\tvar REG_HAS_UNESCAPED_HTML = RegExp(REG_UNESCAPED_HTML.source);\n\tvar REG_IE = /Trident|Edge/;\n\t\n\texports.throttle = function (callback) {\n\t    var throttle = 0;\n\t    var animationCallback = function animationCallback() {\n\t        throttle = 0;\n\t    };\n\t\n\t    return function () {\n\t        if (throttle) {\n\t            return;\n\t        }\n\t\n\t        throttle = raf(animationCallback);\n\t\n\t        callback.apply(this, arguments);\n\t    };\n\t};\n\t\n\texports.escape = function (data) {\n\t    data = String(data);\n\t\n\t    if (data && REG_HAS_UNESCAPED_HTML.test(data)) {\n\t        return data.replace(REG_UNESCAPED_HTML, escapeHtmlChar);\n\t    }\n\t\n\t    return data;\n\t};\n\t\n\texports.unescape = function (data) {\n\t    data = String(data);\n\t\n\t    if (data && REG_HAS_ESCAPED_HTML.test(data)) {\n\t        return data.replace(REG_ESCAPED_HTML, unescapeHtmlChar);\n\t    }\n\t\n\t    return data;\n\t};\n\t\n\texports.canUseDrag = function () {\n\t    return !REG_IE.test(context.navigator.userAgent);\n\t};\n\t\n\tfunction unescapeHtmlChar(chr) {\n\t    return HTML_UNESCAPES[chr];\n\t}\n\t\n\tfunction escapeHtmlChar(chr) {\n\t    return HTML_ESCAPES[chr];\n\t}\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {var now = __webpack_require__(10)\n\t  , root = typeof window === 'undefined' ? global : window\n\t  , vendors = ['moz', 'webkit']\n\t  , suffix = 'AnimationFrame'\n\t  , raf = root['request' + suffix]\n\t  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\t\n\tfor(var i = 0; !raf && i < vendors.length; i++) {\n\t  raf = root[vendors[i] + 'Request' + suffix]\n\t  caf = root[vendors[i] + 'Cancel' + suffix]\n\t      || root[vendors[i] + 'CancelRequest' + suffix]\n\t}\n\t\n\t// Some versions of FF have rAF but not cAF\n\tif(!raf || !caf) {\n\t  var last = 0\n\t    , id = 0\n\t    , queue = []\n\t    , frameDuration = 1000 / 60\n\t\n\t  raf = function(callback) {\n\t    if(queue.length === 0) {\n\t      var _now = now()\n\t        , next = Math.max(0, frameDuration - (_now - last))\n\t      last = next + _now\n\t      setTimeout(function() {\n\t        var cp = queue.slice(0)\n\t        // Clear queue here to prevent\n\t        // callbacks from appending listeners\n\t        // to the current frame's queue\n\t        queue.length = 0\n\t        for(var i = 0; i < cp.length; i++) {\n\t          if(!cp[i].cancelled) {\n\t            try{\n\t              cp[i].callback(last)\n\t            } catch(e) {\n\t              setTimeout(function() { throw e }, 0)\n\t            }\n\t          }\n\t        }\n\t      }, Math.round(next))\n\t    }\n\t    queue.push({\n\t      handle: ++id,\n\t      callback: callback,\n\t      cancelled: false\n\t    })\n\t    return id\n\t  }\n\t\n\t  caf = function(handle) {\n\t    for(var i = 0; i < queue.length; i++) {\n\t      if(queue[i].handle === handle) {\n\t        queue[i].cancelled = true\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\tmodule.exports = function(fn) {\n\t  // Wrap in a new function to prevent\n\t  // `cancel` potentially being assigned\n\t  // to the native rAF function\n\t  return raf.call(root, fn)\n\t}\n\tmodule.exports.cancel = function() {\n\t  caf.apply(root, arguments)\n\t}\n\tmodule.exports.polyfill = function() {\n\t  root.requestAnimationFrame = raf\n\t  root.cancelAnimationFrame = caf\n\t}\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(process) {// Generated by CoffeeScript 1.7.1\n\t(function() {\n\t  var getNanoSeconds, hrtime, loadTime;\n\t\n\t  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n\t    module.exports = function() {\n\t      return performance.now();\n\t    };\n\t  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n\t    module.exports = function() {\n\t      return (getNanoSeconds() - loadTime) / 1e6;\n\t    };\n\t    hrtime = process.hrtime;\n\t    getNanoSeconds = function() {\n\t      var hr;\n\t      hr = hrtime();\n\t      return hr[0] * 1e9 + hr[1];\n\t    };\n\t    loadTime = getNanoSeconds();\n\t  } else if (Date.now) {\n\t    module.exports = function() {\n\t      return Date.now() - loadTime;\n\t    };\n\t    loadTime = Date.now();\n\t  } else {\n\t    module.exports = function() {\n\t      return new Date().getTime() - loadTime;\n\t    };\n\t    loadTime = new Date().getTime();\n\t  }\n\t\n\t}).call(this);\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(11)))\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\t// shim for using process in browser\n\tvar process = module.exports = {};\n\t\n\t// cached from whatever global is present so that test runners that stub it\n\t// don't break things.  But we need to wrap it in a try catch in case it is\n\t// wrapped in strict mode code which doesn't define any globals.  It's inside a\n\t// function because try/catches deoptimize in certain engines.\n\t\n\tvar cachedSetTimeout;\n\tvar cachedClearTimeout;\n\t\n\tfunction defaultSetTimout() {\n\t    throw new Error('setTimeout has not been defined');\n\t}\n\tfunction defaultClearTimeout () {\n\t    throw new Error('clearTimeout has not been defined');\n\t}\n\t(function () {\n\t    try {\n\t        if (typeof setTimeout === 'function') {\n\t            cachedSetTimeout = setTimeout;\n\t        } else {\n\t            cachedSetTimeout = defaultSetTimout;\n\t        }\n\t    } catch (e) {\n\t        cachedSetTimeout = defaultSetTimout;\n\t    }\n\t    try {\n\t        if (typeof clearTimeout === 'function') {\n\t            cachedClearTimeout = clearTimeout;\n\t        } else {\n\t            cachedClearTimeout = defaultClearTimeout;\n\t        }\n\t    } catch (e) {\n\t        cachedClearTimeout = defaultClearTimeout;\n\t    }\n\t} ())\n\tfunction runTimeout(fun) {\n\t    if (cachedSetTimeout === setTimeout) {\n\t        //normal enviroments in sane situations\n\t        return setTimeout(fun, 0);\n\t    }\n\t    // if setTimeout wasn't available but was latter defined\n\t    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n\t        cachedSetTimeout = setTimeout;\n\t        return setTimeout(fun, 0);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedSetTimeout(fun, 0);\n\t    } catch(e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n\t            return cachedSetTimeout.call(null, fun, 0);\n\t        } catch(e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n\t            return cachedSetTimeout.call(this, fun, 0);\n\t        }\n\t    }\n\t\n\t\n\t}\n\tfunction runClearTimeout(marker) {\n\t    if (cachedClearTimeout === clearTimeout) {\n\t        //normal enviroments in sane situations\n\t        return clearTimeout(marker);\n\t    }\n\t    // if clearTimeout wasn't available but was latter defined\n\t    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n\t        cachedClearTimeout = clearTimeout;\n\t        return clearTimeout(marker);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedClearTimeout(marker);\n\t    } catch (e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n\t            return cachedClearTimeout.call(null, marker);\n\t        } catch (e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n\t            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n\t            return cachedClearTimeout.call(this, marker);\n\t        }\n\t    }\n\t\n\t\n\t\n\t}\n\tvar queue = [];\n\tvar draining = false;\n\tvar currentQueue;\n\tvar queueIndex = -1;\n\t\n\tfunction cleanUpNextTick() {\n\t    if (!draining || !currentQueue) {\n\t        return;\n\t    }\n\t    draining = false;\n\t    if (currentQueue.length) {\n\t        queue = currentQueue.concat(queue);\n\t    } else {\n\t        queueIndex = -1;\n\t    }\n\t    if (queue.length) {\n\t        drainQueue();\n\t    }\n\t}\n\t\n\tfunction drainQueue() {\n\t    if (draining) {\n\t        return;\n\t    }\n\t    var timeout = runTimeout(cleanUpNextTick);\n\t    draining = true;\n\t\n\t    var len = queue.length;\n\t    while(len) {\n\t        currentQueue = queue;\n\t        queue = [];\n\t        while (++queueIndex < len) {\n\t            if (currentQueue) {\n\t                currentQueue[queueIndex].run();\n\t            }\n\t        }\n\t        queueIndex = -1;\n\t        len = queue.length;\n\t    }\n\t    currentQueue = null;\n\t    draining = false;\n\t    runClearTimeout(timeout);\n\t}\n\t\n\tprocess.nextTick = function (fun) {\n\t    var args = new Array(arguments.length - 1);\n\t    if (arguments.length > 1) {\n\t        for (var i = 1; i < arguments.length; i++) {\n\t            args[i - 1] = arguments[i];\n\t        }\n\t    }\n\t    queue.push(new Item(fun, args));\n\t    if (queue.length === 1 && !draining) {\n\t        runTimeout(drainQueue);\n\t    }\n\t};\n\t\n\t// v8 likes predictible objects\n\tfunction Item(fun, array) {\n\t    this.fun = fun;\n\t    this.array = array;\n\t}\n\tItem.prototype.run = function () {\n\t    this.fun.apply(null, this.array);\n\t};\n\tprocess.title = 'browser';\n\tprocess.browser = true;\n\tprocess.env = {};\n\tprocess.argv = [];\n\tprocess.version = ''; // empty string to avoid regexp issues\n\tprocess.versions = {};\n\t\n\tfunction noop() {}\n\t\n\tprocess.on = noop;\n\tprocess.addListener = noop;\n\tprocess.once = noop;\n\tprocess.off = noop;\n\tprocess.removeListener = noop;\n\tprocess.removeAllListeners = noop;\n\tprocess.emit = noop;\n\t\n\tprocess.binding = function (name) {\n\t    throw new Error('process.binding is not supported');\n\t};\n\t\n\tprocess.cwd = function () { return '/' };\n\tprocess.chdir = function (dir) {\n\t    throw new Error('process.chdir is not supported');\n\t};\n\tprocess.umask = function() { return 0; };\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\t/**\n\t * @module x-bubbles/event\n\t */\n\t\n\tvar context = __webpack_require__(1);\n\tvar CustomEventCommon = __webpack_require__(13);\n\t\n\texports.scrollX = scrollX;\n\texports.scrollY = scrollY;\n\texports.dispatch = dispatch;\n\t\n\texports.keyCode = function (event) {\n\t    return event.charCode || event.keyCode;\n\t};\n\t\n\texports.metaKey = function (event) {\n\t    return event.ctrlKey || event.metaKey;\n\t};\n\t\n\texports.pageX = function (event) {\n\t    return event.pageX === null && event.clientX !== null ? event.clientX + scrollX() : event.pageX;\n\t};\n\t\n\texports.pageY = function (event) {\n\t    return event.pageY === null && event.clientY !== null ? event.clientY + scrollY() : event.pageY;\n\t};\n\t\n\texports.one = function (target, eventName, callback) {\n\t    var events = callback ? _defineProperty({}, eventName, callback) : eventName;\n\t    for (var name in events) {\n\t        target.addEventListener(name, oneCallback(target, name, events[name]));\n\t    }\n\t};\n\t\n\texports.on = function (target, eventName, callback) {\n\t    var events = callback ? _defineProperty({}, eventName, callback) : eventName;\n\t    for (var name in events) {\n\t        target.addEventListener(name, events[name]);\n\t    }\n\t};\n\t\n\texports.off = function (target, eventName, callback) {\n\t    var events = callback ? _defineProperty({}, eventName, callback) : eventName;\n\t    for (var name in events) {\n\t        target.removeEventListener(name, events[name]);\n\t    }\n\t};\n\t\n\texports.prevent = function (event) {\n\t    event.cancelBubble = true;\n\t    event.returnValue = false;\n\t    event.stopImmediatePropagation();\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t    return false;\n\t};\n\t\n\tfunction scrollX() {\n\t    var html = context.document.documentElement;\n\t    var body = context.document.body;\n\t    return (html && html.scrollLeft || body && body.scrollLeft || 0) - (html.clientLeft || 0);\n\t}\n\t\n\tfunction scrollY() {\n\t    var html = context.document.documentElement;\n\t    var body = context.document.body;\n\t    return (html && html.scrollTop || body && body.scrollTop || 0) - (html.clientTop || 0);\n\t}\n\t\n\t/**\n\t * Designer events.\n\t *\n\t * @example\n\t * const { Custom } = require('event');\n\t *\n\t * new Custom('custom-event', {\n\t *     bubbles: true,\n\t *     cancelable: true,\n\t *     detail: { data: '123' }\n\t * })\n\t *\n\t * @alias module:x-bubbles/event~Custom\n\t * @constructor\n\t */\n\tvar Custom = function () {\n\t    if (typeof context.CustomEvent === 'function') {\n\t        return context.CustomEvent;\n\t    }\n\t\n\t    return CustomEventCommon;\n\t}();\n\t\n\t/**\n\t * Dispatch event.\n\t *\n\t * @example\n\t * const { dispatch } = require('event');\n\t * dispatch(node, 'custom-event', {\n\t *     bubbles: true,\n\t *     cancelable: true,\n\t *     detail: { data: '123' }\n\t * })\n\t *\n\t * @alias module:x-bubbles/event.dispatch\n\t * @param {HTMLElement} element node events\n\t * @param {string} name event name\n\t * @param {Object} params the event parameters\n\t * @param {boolean} [params.bubbles=false]\n\t * @param {boolean} [params.cancelable=false]\n\t * @param {*} [params.detail]\n\t */\n\tfunction dispatch(element, name) {\n\t    var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t    element.dispatchEvent(new Custom(name, params));\n\t}\n\t\n\tfunction oneCallback(target, eventName, callback) {\n\t    return function _callback(event) {\n\t        target.removeEventListener(eventName, _callback);\n\t        callback(event);\n\t    };\n\t}\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\t\n\t/**\n\t * @constant {Document}\n\t * @private\n\t */\n\tvar doc = context.document;\n\t\n\t/**\n\t * @constant {Object}\n\t * @private\n\t */\n\tvar protoEvent = context.Event.prototype;\n\t\n\tvar issetCustomEvent = false;\n\t\n\ttry {\n\t    issetCustomEvent = Boolean(doc.createEvent('CustomEvent'));\n\t} catch (e) {}\n\t// do nothing\n\t\n\t\n\t/**\n\t * The original function \"stopImmediatePropagation\"\n\t * @constant {function}\n\t * @private\n\t */\n\tvar stopImmediatePropagation = protoEvent.stopImmediatePropagation;\n\t\n\t/**\n\t * Override function to set properties \"immediatePropagationStopped\"\n\t */\n\tprotoEvent.stopImmediatePropagation = function () {\n\t    this.immediatePropagationStopped = true;\n\t\n\t    if (stopImmediatePropagation) {\n\t        stopImmediatePropagation.call(this);\n\t    } else {\n\t        this.stopPropagation();\n\t    }\n\t};\n\t\n\tvar CustomEventCommon = function () {\n\t    if (issetCustomEvent) {\n\t        return function (eventName, params) {\n\t            params = params || {};\n\t\n\t            var bubbles = Boolean(params.bubbles);\n\t            var cancelable = Boolean(params.cancelable);\n\t            var evt = doc.createEvent('CustomEvent');\n\t\n\t            evt.initCustomEvent(eventName, bubbles, cancelable, params.detail);\n\t\n\t            return evt;\n\t        };\n\t    }\n\t\n\t    return function (eventName, params) {\n\t        params = params || {};\n\t\n\t        var bubbles = Boolean(params.bubbles);\n\t        var cancelable = Boolean(params.cancelable);\n\t        var evt = doc.createEvent('Event');\n\t\n\t        evt.initEvent(eventName, bubbles, cancelable);\n\t        evt.detail = params.detail;\n\t\n\t        return evt;\n\t    };\n\t}();\n\t\n\tCustomEventCommon.prototype = protoEvent;\n\t\n\tmodule.exports = CustomEventCommon;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\texports.KEY = {\n\t    a: 65,\n\t    c: 67,\n\t    Backspace: 8,\n\t    Bottom: 40,\n\t    Cmd: 91,\n\t    Comma: 44, // ,\n\t    Enter: 13, // Enter\n\t    Esc: 27,\n\t    Left: 37,\n\t    Right: 39,\n\t    Semicolon: 59, // ;\n\t    Space: 32,\n\t    Tab: 9,\n\t    Top: 38\n\t};\n\t\n\texports.CLS = {\n\t    DRAGSTART: 'drag',\n\t    DROPZONE: 'dropzone'\n\t};\n\t\n\texports.EV = {\n\t    BUBBLE_EDIT: 'bubble-edit',\n\t    BUBBLE_INPUT: 'bubble-input',\n\t    CHANGE: 'change',\n\t    DRAGEND: 'dragend',\n\t    DRAGENTER: 'dragenter',\n\t    DRAGLEAVE: 'dragleave',\n\t    DRAGSTART: 'dragstart',\n\t    DROP: 'drop'\n\t};\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar DRAG_IMG_WIDTH = 16;\n\t\n\tvar dragImage = null;\n\t\n\texports.DRAG_IMG_WIDTH = DRAG_IMG_WIDTH;\n\t\n\texports.getDragImage = function () {\n\t    if (!dragImage) {\n\t        dragImage = new Image();\n\t        dragImage.src = __webpack_require__(16);\n\t    }\n\t\n\t    return dragImage;\n\t};\n\t\n\texports.onDropSuccess = function (fromNodeSet, toNodeSet) {\n\t    fromNodeSet.fireChange();\n\t    toNodeSet.focus();\n\t    toNodeSet.fireChange();\n\t};\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB3klEQVR4XtWWMWgTYRTH/0n0IjWNkSo9jYJTx4KDAXWoIChtqdBFkG6lTm5iiw5OHQQFV4fSunYTOpVucbRDBicVUmmb0GsuJCYGknjfez4+PmjUy8U7cegffty3vPfjfY/jLsbM+J+JC8dbcAIm97aqEwBeCjmEywdhaePOSD5QQETr1y6m7Ww6iTApNTq57XJjHcCFYIEiGyeTKLYQKkmp0bWDrkiRQstD6HikazFYoBQIEWJql9+Ncu9Ons86+d8EBOKoAsLtG9P67FTLuY+fC3onf0zgcfQJKu1tfbaGU2Bm2+eKvKgTmFpdjK5qgtlnB17kHZjanq5M7LvkkltvZs+khxEm3xpNDCUqvwjIX0ALX4o7bwHYAs6fG8HlS1ns7ZdQcavol9NWHVNjb6COBP5XVJgf3+x9G8dXCuwpguu6eDrxAINCjIAJfFCk4Bw6eHZrLvTy+W8EpAiPrt6HYgth0qx1wcylgYKZobuTu59gduKfs6OnYF9J4eDrd9ScNkwOhAWY/NMXbXEtwxmR1KX5q/l6LOB7EAnd9MlqhhGQWM8zLiSM1IC4pn9uCtcfr6QXXz9svADwXsgLnqAEFgE0prklJA2WkSSEWICEDD+ErtAR2jCS4/9X8RPiO+YqXEJbcwAAAABJRU5ErkJggg==\"\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(1);\n\tvar events = __webpack_require__(12);\n\tvar utils = __webpack_require__(8);\n\tvar select = __webpack_require__(4);\n\tvar bubbleset = __webpack_require__(7);\n\tvar Modernizr = __webpack_require__(18);\n\t\n\tvar _require = __webpack_require__(14);\n\t\n\tvar CLS = _require.CLS;\n\tvar EV = _require.EV;\n\t\n\tvar _require2 = __webpack_require__(15);\n\t\n\tvar getDragImage = _require2.getDragImage;\n\tvar onDropSuccess = _require2.onDropSuccess;\n\tvar DRAG_IMG_WIDTH = _require2.DRAG_IMG_WIDTH;\n\t\n\t\n\tvar currentDragSet = null;\n\tvar currentMoveSet = null;\n\tvar currentDragElement = null;\n\t\n\texports.init = function (nodeSet) {\n\t    events.on(nodeSet, 'mousedown', onMousedown);\n\t};\n\t\n\texports.destroy = function (nodeSet) {\n\t    events.off(nodeSet, 'mousedown', onMousedown);\n\t};\n\t\n\tfunction onMousedown(event) {\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t    if (!nodeBubble) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    if (!nodeSet) {\n\t        return;\n\t    }\n\t\n\t    event.preventDefault();\n\t    nodeSet.focus();\n\t\n\t    var drag = nodeSet.__drag__ = {\n\t        onMouseup: onMouseup.bind(this, nodeSet),\n\t        onMousemove: utils.throttle(onMousemove.bind(this, nodeSet)),\n\t        onScroll: utils.throttle(onScroll.bind(this, nodeSet)),\n\t        nodeOffsetX: event.offsetX,\n\t        nodeOffsetY: event.offsetY,\n\t        x: 0,\n\t        y: 0\n\t    };\n\t\n\t    currentDragSet = null;\n\t    currentMoveSet = null;\n\t    currentDragElement = null;\n\t\n\t    events.one(document, 'mouseup', drag.onMouseup);\n\t    events.on(document, 'mousemove', drag.onMousemove);\n\t    events.on(document, 'scroll', drag.onScroll);\n\t}\n\t\n\tfunction onMouseup(dragSet, event) {\n\t    var drag = dragSet.__drag__;\n\t    if (!drag) {\n\t        return;\n\t    }\n\t\n\t    events.off(document, 'mousemove', drag.onMousemove);\n\t    events.off(document, 'scroll', drag.onScroll);\n\t    delete dragSet.__drag__;\n\t\n\t    if (currentDragElement) {\n\t        currentDragElement.parentNode && currentDragElement.parentNode.removeChild(currentDragElement);\n\t        currentDragElement = null;\n\t    }\n\t\n\t    if (currentMoveSet) {\n\t        var _ = currentMoveSet;\n\t        currentMoveSet = null;\n\t\n\t        _.classList.remove(CLS.DROPZONE);\n\t        events.dispatch(_, EV.DRAGLEAVE, { bubbles: false, cancelable: false });\n\t    }\n\t\n\t    if (currentDragSet) {\n\t        (function () {\n\t            var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t            if (nodeSet && nodeSet !== currentDragSet) {\n\t                var list = select.get(currentDragSet);\n\t\n\t                if (list.length) {\n\t                    list.forEach(function (item) {\n\t                        return nodeSet.appendChild(item);\n\t                    });\n\t                    context.setTimeout(onDropSuccess, 0, currentDragSet, nodeSet);\n\t                }\n\t            }\n\t\n\t            var _ = currentDragSet;\n\t            currentDragSet = null;\n\t\n\t            _.classList.remove(CLS.DRAGSTART);\n\t            events.dispatch(_, EV.DROP, { bubbles: false, cancelable: false });\n\t            events.dispatch(_, EV.DRAGEND, { bubbles: false, cancelable: false });\n\t        })();\n\t    }\n\t}\n\t\n\tfunction onMousemove(dragSet, event) {\n\t    var drag = dragSet.__drag__;\n\t    if (!drag) {\n\t        return;\n\t    }\n\t\n\t    if (!currentDragSet) {\n\t        var selection = context.getSelection();\n\t        selection && selection.removeAllRanges();\n\t\n\t        currentDragSet = dragSet;\n\t        currentDragSet.classList.add(CLS.DRAGSTART);\n\t\n\t        var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t        var moveElement = void 0;\n\t\n\t        if (nodeBubble) {\n\t            select.add(nodeBubble);\n\t            if (select.get(currentDragSet).length === 1) {\n\t                moveElement = nodeBubble.cloneNode(true);\n\t            }\n\t        }\n\t\n\t        if (!moveElement) {\n\t            moveElement = getDragImage();\n\t            drag.nodeOffsetX = DRAG_IMG_WIDTH;\n\t            drag.nodeOffsetY = DRAG_IMG_WIDTH;\n\t        }\n\t\n\t        currentDragElement = document.body.appendChild(document.createElement('div'));\n\t        currentDragElement.style.cssText = 'position:absolute;z-index:9999;pointer-events:none;top:0;left:0;';\n\t        currentDragElement.appendChild(moveElement);\n\t\n\t        events.dispatch(currentDragSet, EV.DRAGSTART, { bubbles: false, cancelable: false });\n\t    }\n\t\n\t    drag.x = event.clientX;\n\t    drag.y = event.clientY;\n\t    onScroll(dragSet);\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    if (nodeSet && nodeSet !== currentDragSet) {\n\t        if (currentMoveSet && currentMoveSet !== nodeSet) {\n\t            currentMoveSet.classList.remove(CLS.DROPZONE);\n\t            nodeSet.classList.add(CLS.DROPZONE);\n\t            currentMoveSet = nodeSet;\n\t            events.dispatch(currentMoveSet, EV.DRAGENTER, { bubbles: false, cancelable: false });\n\t        } else if (!currentMoveSet) {\n\t            nodeSet.classList.add(CLS.DROPZONE);\n\t            currentMoveSet = nodeSet;\n\t            events.dispatch(currentMoveSet, EV.DRAGENTER, { bubbles: false, cancelable: false });\n\t        }\n\t    } else if (currentMoveSet) {\n\t        var _ = currentMoveSet;\n\t        currentMoveSet = null;\n\t\n\t        _.classList.remove(CLS.DROPZONE);\n\t        events.dispatch(_, EV.DRAGLEAVE, { bubbles: false, cancelable: false });\n\t    }\n\t}\n\t\n\tfunction onScroll(dragSet) {\n\t    var drag = dragSet.__drag__;\n\t    if (!drag || !currentDragElement) {\n\t        return;\n\t    }\n\t\n\t    var x = drag.x - drag.nodeOffsetX + events.scrollX();\n\t    var y = drag.y - drag.nodeOffsetY + events.scrollY();\n\t\n\t    if (Modernizr.csstransforms3d) {\n\t        currentDragElement.style.transform = 'translate3d(' + x + 'px, ' + y + 'px, 0px)';\n\t    } else if (Modernizr.csstransforms) {\n\t        currentDragElement.style.transform = 'translate(' + x + 'px, ' + y + 'px)';\n\t    } else {\n\t        currentDragElement.style.top = y + 'px';\n\t        currentDragElement.style.left = x + 'px';\n\t    }\n\t}\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\tmodule.exports = Modernizr;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar raf = __webpack_require__(9);\n\tvar context = __webpack_require__(1);\n\tvar bubbleset = __webpack_require__(7);\n\tvar bubble = __webpack_require__(5);\n\tvar cursor = __webpack_require__(20);\n\tvar select = __webpack_require__(4);\n\t\n\tvar _require = __webpack_require__(14);\n\t\n\tvar KEY = _require.KEY;\n\tvar EV = _require.EV;\n\t\n\tvar text = __webpack_require__(6);\n\tvar events = __webpack_require__(12);\n\tvar utils = __webpack_require__(8);\n\tvar copy = __webpack_require__(21);\n\t\n\tvar EVENTS = {\n\t    blur: onBlur,\n\t    click: onClick,\n\t    dblclick: onDblclick,\n\t    focus: onFocus,\n\t    keydown: onKeydown,\n\t    keypress: onKeypress,\n\t    keyup: onKeyup,\n\t    mscontrolselect: events.prevent,\n\t    paste: onPaste,\n\t    resize: events.prevent,\n\t    resizestart: events.prevent\n\t};\n\t\n\texports.init = function (nodeEditor) {\n\t    nodeEditor.setAttribute('contenteditable', 'true');\n\t    nodeEditor.setAttribute('spellcheck', 'false');\n\t\n\t    nodeEditor.fireChange = utils.throttle(fireChange);\n\t    nodeEditor.fireEdit = utils.throttle(fireEdit);\n\t    nodeEditor.fireInput = utils.throttle(fireInput);\n\t\n\t    events.on(nodeEditor, EVENTS);\n\t\n\t    return {\n\t        addBubble: addBubble.bind(nodeEditor),\n\t        editBubble: editBubble.bind(nodeEditor),\n\t        removeBubble: removeBubble.bind(nodeEditor),\n\t        setContent: setContent.bind(nodeEditor)\n\t    };\n\t};\n\t\n\texports.destroy = function (nodeEditor) {\n\t    events.off(nodeEditor, EVENTS);\n\t};\n\t\n\tfunction onBlur(event) {\n\t    var nodeEditor = event.currentTarget;\n\t    if (nodeEditor._lockCopy) {\n\t        return events.prevent(event);\n\t    }\n\t\n\t    select.clear(nodeEditor);\n\t    bubble.bubbling(nodeEditor);\n\t}\n\t\n\tfunction onFocus(event) {\n\t    var nodeEditor = event.currentTarget;\n\t    if (nodeEditor._lockCopy) {\n\t        events.prevent(event);\n\t        delete nodeEditor._lockCopy;\n\t\n\t        // Safary 10     \n\t        raf(function () {\n\t            var selection = context.getSelection();\n\t            selection && selection.removeAllRanges();\n\t        });\n\t\n\t        return false;\n\t    }\n\t\n\t    cursor.restore(nodeEditor);\n\t}\n\t\n\tfunction onKeyup(event) {\n\t    var nodeEditor = event.currentTarget;\n\t    var code = events.keyCode(event);\n\t    var isPrintableChar = event.key ? event.key.length === 1 : (code > 47 || code === KEY.Space || code === KEY.Backspace) && code !== KEY.Cmd;\n\t\n\t    if (isPrintableChar) {\n\t        nodeEditor.fireInput();\n\t    }\n\t}\n\t\n\tfunction onKeypress(event) {\n\t    var code = events.keyCode(event);\n\t    var nodeEditor = event.currentTarget;\n\t\n\t    /* eslint no-case-declarations: 0 */\n\t    switch (code) {\n\t        case KEY.Enter:\n\t            event.preventDefault();\n\t            if (!nodeEditor.options('disableControls')) {\n\t                bubble.bubbling(nodeEditor);\n\t                cursor.restore(nodeEditor);\n\t            }\n\t            break;\n\t\n\t        case KEY.Comma:\n\t        case KEY.Semicolon:\n\t            event.preventDefault();\n\t            bubble.bubbling(nodeEditor);\n\t            cursor.restore(nodeEditor);\n\t            break;\n\t    }\n\t}\n\t\n\tfunction onKeydown(event) {\n\t    var code = events.keyCode(event);\n\t    var metaKey = events.metaKey(event);\n\t    var nodeEditor = event.currentTarget;\n\t    var enable = !nodeEditor.options('disableControls');\n\t\n\t    switch (code) {\n\t        case KEY.Esc:\n\t            event.preventDefault();\n\t            bubble.bubbling(nodeEditor);\n\t            cursor.restore(nodeEditor);\n\t            break;\n\t\n\t        case KEY.Backspace:\n\t            event.preventDefault();\n\t            backSpace(event);\n\t            break;\n\t\n\t        case KEY.Left:\n\t            event.preventDefault();\n\t            arrowLeft(event);\n\t            break;\n\t\n\t        //     \n\t        case KEY.Top:\n\t            event.preventDefault();\n\t            if (enable) {\n\t                var headBubble = bubbleset.headBubble(nodeEditor);\n\t                headBubble && select.uniq(headBubble);\n\t            }\n\t            break;\n\t\n\t        case KEY.Right:\n\t            event.preventDefault();\n\t            arrowRight(event);\n\t            break;\n\t\n\t        //     \n\t        // case KEY.Tab:\n\t        case KEY.Bottom:\n\t            event.preventDefault();\n\t            if (enable && select.has(nodeEditor)) {\n\t                cursor.restore(nodeEditor);\n\t            }\n\t            break;\n\t\n\t        case KEY.a:\n\t            if (metaKey) {\n\t                event.preventDefault();\n\t\n\t                if (!text.selectAll(null, event.currentTarget)) {\n\t                    select.all(nodeEditor);\n\t                }\n\t            }\n\t            break;\n\t\n\t        case KEY.c:\n\t            if (metaKey) {\n\t                copy(nodeEditor);\n\t            }\n\t            break;\n\t    }\n\t}\n\t\n\tfunction arrowLeft(event) {\n\t    var selection = context.getSelection();\n\t\n\t    if (text.arrowLeft(selection, event.shiftKey)) {\n\t        return;\n\t    }\n\t\n\t    if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n\t        var nodeBubble = bubbleset.prevBubble(selection.anchorNode);\n\t        nodeBubble && select.uniq(nodeBubble);\n\t        return;\n\t    }\n\t\n\t    var nodeSet = event.currentTarget;\n\t    var list = select.get(nodeSet);\n\t    var begin = list.length > 1 && list[0] === nodeSet.startRangeSelect ? list[list.length - 1] : list[0];\n\t\n\t    var node = bubbleset.prevBubble(begin);\n\t\n\t    if (node) {\n\t        if (event.shiftKey) {\n\t            select.range(node);\n\t        } else {\n\t            select.uniq(node);\n\t        }\n\t    }\n\t}\n\t\n\tfunction arrowRight(event) {\n\t    var selection = context.getSelection();\n\t\n\t    if (text.arrowRight(selection, event.shiftKey)) {\n\t        return;\n\t    }\n\t\n\t    if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n\t        var nodeBubble = bubbleset.nextBubble(selection.focusNode);\n\t        nodeBubble && select.uniq(nodeBubble);\n\t        return;\n\t    }\n\t\n\t    var nodeSet = event.currentTarget;\n\t    var list = select.get(nodeSet);\n\t    var begin = list.length > 1 && list[list.length - 1] === nodeSet.startRangeSelect ? list[0] : list[list.length - 1];\n\t\n\t    var node = bubbleset.nextBubble(begin);\n\t\n\t    if (node) {\n\t        if (event.shiftKey) {\n\t            select.range(node);\n\t        } else {\n\t            select.uniq(node);\n\t        }\n\t    } else if (begin && begin.nextSibling && begin.nextSibling.nodeType === Node.TEXT_NODE) {\n\t        select.clear(nodeSet);\n\t        selection.collapse(begin.nextSibling, 0);\n\t    } else {\n\t        cursor.restore(nodeSet);\n\t    }\n\t}\n\t\n\tfunction backSpace(event) {\n\t    var nodeSet = event.currentTarget;\n\t    nodeSet.normalize();\n\t\n\t    var selection = context.getSelection();\n\t    if (!selection) {\n\t        return;\n\t    }\n\t\n\t    if (selection.isCollapsed) {\n\t        if (text.arrowLeft(selection, true)) {\n\t            text.remove(selection);\n\t            nodeSet.fireInput();\n\t            return;\n\t        }\n\t    } else {\n\t        text.remove(selection);\n\t        nodeSet.fireInput();\n\t        return;\n\t    }\n\t\n\t    var node = bubbleset.findBubbleLeft(selection);\n\t    if (node) {\n\t        select.uniq(node);\n\t        return;\n\t    }\n\t\n\t    var list = select.get(nodeSet);\n\t\n\t    if (list.length) {\n\t        var prevBubble = list[0].previousSibling;\n\t        var nextBubble = list[list.length - 1].nextSibling;\n\t        list.forEach(function (item) {\n\t            return item.parentNode.removeChild(item);\n\t        });\n\t\n\t        if (bubble.isBubbleNode(prevBubble)) {\n\t            select.uniq(prevBubble);\n\t        } else if (bubble.isBubbleNode(nextBubble)) {\n\t            select.uniq(nextBubble);\n\t        } else {\n\t            nodeSet.focus();\n\t            cursor.restore(nodeSet);\n\t        }\n\t\n\t        nodeSet.fireChange();\n\t    }\n\t}\n\t\n\tfunction onPaste(event) {\n\t    event.preventDefault();\n\t    var nodeSet = event.currentTarget;\n\t\n\t    if (context.clipboardData && context.clipboardData.getData) {\n\t        text.replaceString(context.clipboardData.getData('Text'));\n\t        nodeSet.fireInput();\n\t    } else if (event.clipboardData) {\n\t        (function () {\n\t            var contentType = 'text/plain';\n\t            var clipboardData = event.clipboardData;\n\t            var data = clipboardData.getData && clipboardData.getData(contentType);\n\t\n\t            if (text.replaceString(data)) {\n\t                nodeSet.fireInput();\n\t            } else if (clipboardData.items) {\n\t                Array.prototype.slice.call(clipboardData.items).filter(function (item) {\n\t                    return item.kind === 'string' && item.type === contentType;\n\t                }).some(function (item) {\n\t                    item.getAsString(function (dataPaste) {\n\t                        text.replaceString(dataPaste);\n\t                        nodeSet.fireInput();\n\t                    });\n\t\n\t                    return true;\n\t                });\n\t            }\n\t        })();\n\t    }\n\t}\n\t\n\tfunction onDblclick(event) {\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (nodeSet && nodeBubble) {\n\t        event.preventDefault();\n\t        bubble.edit(nodeSet, nodeBubble);\n\t    }\n\t}\n\t\n\tfunction onClick(event) {\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (nodeBubble) {\n\t        if (events.metaKey(event)) {\n\t            select.add(nodeBubble);\n\t        } else if (event.shiftKey) {\n\t            if (!nodeSet.startRangeSelect) {\n\t                select.uniq(nodeBubble);\n\t            } else {\n\t                select.range(nodeBubble);\n\t            }\n\t        } else {\n\t            select.toggleUniq(nodeBubble);\n\t        }\n\t    } else {\n\t        select.clear(nodeSet);\n\t\n\t        var selection = context.getSelection();\n\t\n\t        if (!selection || !selection.anchorNode || selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\t\n\t            cursor.restore(nodeSet);\n\t        }\n\t    }\n\t}\n\t\n\tfunction setContent(data) {\n\t    while (this.firstChild) {\n\t        this.removeChild(this.firstChild);\n\t    }\n\t\n\t    data = text.html2text(data);\n\t    this.appendChild(context.document.createTextNode(data));\n\t    bubble.bubbling(this);\n\t    cursor.restore(this);\n\t}\n\t\n\tfunction addBubble(bubbleText, data) {\n\t    var nodeBubble = bubble.create(this, bubbleText, data);\n\t    if (!nodeBubble) {\n\t        return false;\n\t    }\n\t\n\t    if (text.text2bubble(this, nodeBubble)) {\n\t        this.fireInput();\n\t        this.fireChange();\n\t        cursor.restore(this);\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction removeBubble(nodeBubble) {\n\t    if (this.contains(nodeBubble)) {\n\t        this.removeChild(nodeBubble);\n\t        this.fireChange();\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction editBubble(nodeBubble) {\n\t    if (this.contains(nodeBubble)) {\n\t        return bubble.edit(this, nodeBubble);\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction fireEdit(nodeBubble) {\n\t    events.dispatch(this, EV.BUBBLE_EDIT, {\n\t        bubbles: false,\n\t        cancelable: false,\n\t        detail: { data: nodeBubble }\n\t    });\n\t}\n\t\n\tfunction fireChange() {\n\t    events.dispatch(this, EV.CHANGE, {\n\t        bubbles: false,\n\t        cancelable: false\n\t    });\n\t}\n\t\n\tfunction fireInput() {\n\t    var textRange = text.currentTextRange();\n\t    var editText = textRange && text.textClean(textRange.toString()) || '';\n\t\n\t    if (this._bubbleValue !== editText) {\n\t        this._bubbleValue = editText;\n\t\n\t        events.dispatch(this, EV.BUBBLE_INPUT, {\n\t            bubbles: false,\n\t            cancelable: false,\n\t            detail: { data: editText }\n\t        });\n\t    }\n\t}\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/**\n\t * @module x-bubbles/cursor\n\t */\n\t\n\tvar context = __webpack_require__(1);\n\tvar text = __webpack_require__(6);\n\tvar select = __webpack_require__(4);\n\t\n\texports.restore = restore;\n\texports.restoreBasis = restoreBasis;\n\t\n\t/**\n\t * Reset the cursor position to the end of the input field.\n\t * @alias module:x-bubbles/cursor.restore\n\t * @param {HTMLElement} nodeSet\n\t */\n\tfunction restore(nodeSet) {\n\t    select.clear(nodeSet);\n\t    var basis = restoreBasis(nodeSet);\n\t    var selection = context.getSelection();\n\t    selection.removeAllRanges();\n\t    selection.collapse(basis, 1);\n\t}\n\t\n\t/**\n\t * The creation of the fake text at the end childNodes\n\t * @alias module:x-bubbles/cursor.restoreBasis\n\t * @param {HTMLElement} nodeSet\n\t * @returns {HTMLTextElement} fake text node\n\t */\n\tfunction restoreBasis(nodeSet) {\n\t    var fakeText = text.createZws();\n\t\n\t    if (nodeSet.hasChildNodes()) {\n\t        var lastNode = nodeSet.childNodes[nodeSet.childNodes.length - 1];\n\t\n\t        if (lastNode.isEqualNode(fakeText)) {\n\t            fakeText = lastNode;\n\t        } else {\n\t            nodeSet.appendChild(fakeText);\n\t        }\n\t    } else {\n\t        nodeSet.appendChild(fakeText);\n\t    }\n\t\n\t    return fakeText;\n\t}\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar events = __webpack_require__(12);\n\tvar select = __webpack_require__(4);\n\t\n\tmodule.exports = function (nodeSet) {\n\t    var selection = nodeSet.ownerDocument.defaultView.getSelection();\n\t    if (selection && selection.anchorNode) {\n\t        return;\n\t    }\n\t\n\t    var list = select.get(nodeSet);\n\t    if (!list.length) {\n\t        return;\n\t    }\n\t\n\t    var bubbleCopy = nodeSet.options('bubbleCopy');\n\t    var value = bubbleCopy(list);\n\t    if (!value) {\n\t        return;\n\t    }\n\t\n\t    nodeSet._lockCopy = true;\n\t\n\t    var target = nodeSet.ownerDocument.createElement('input');\n\t    target.value = value;\n\t    target.style.cssText = '\\n        position: absolute;\\n        top: -9999px;\\n        width: 1px;\\n        height: 1px;\\n        margin: 0;\\n        padding: 0;\\n        border: none;';\n\t\n\t    nodeSet.ownerDocument.body.appendChild(target);\n\t\n\t    events.one(target, {\n\t        blur: function blur() {\n\t            return removeNode(target);\n\t        },\n\t        keyup: function keyup() {\n\t            nodeSet.focus();\n\t            removeNode(target);\n\t        }\n\t    });\n\t\n\t    target.select();\n\t};\n\t\n\tfunction removeNode(node) {\n\t    node.parentNode && node.parentNode.removeChild(node);\n\t}\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** x-bubbles-compact.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap cf39d06a4cd24c1e24e5\n **/","const context = require('./context');\nconst drag = require('./core/drag');\nconst editor = require('./core/editor');\nconst bubble = require('./core/bubble');\nconst bubbleset = require('./core/bubbleset');\n\nconst OPTIONS = {\n    begining:           [ 'noop', null ],\n    bubbleCopy:         [ 'funk', function () {} ],\n    bubbleDeformation:  [ 'funk', function () {} ],\n    bubbleFormation:    [ 'funk', function () {} ],\n    classBubble:        [ 'noop', 'bubble' ],\n    draggable:          [ 'bool', true ],\n    disableControls:    [ 'bool', false ],\n    ending:             [ 'noop', null ], // /\\@ya\\.ru/g;\n    separator:          [ 'noop', /[,;]/ ],\n};\n\nconst XBubbles = Object.create(HTMLDivElement.prototype, {\n    createdCallback: {\n        value: function () {\n            initEditor(this);\n        }\n    },\n\n    attachedCallback: {\n        value: function () {\n            initEditor(this);\n            drag.init(this);\n            bubble.bubbling(this);\n        }\n    },\n\n    detachedCallback: {\n        value: function () {\n            drag.destroy(this);\n            destroyEditor(this);\n        }\n    },\n\n    /*\n    attributeChangedCallback: {\n        value: function (name, prevValue, value) {}\n    },\n    */\n\n    options: {\n        value: function (name, value) {\n            if (!this._options) {\n                this._options = {\n                    ...Object.keys(OPTIONS).reduce(function (result, item) {\n                        result[ item ] = undefined;\n                        return result;\n                    }, {}),\n\n                    ...this.dataset\n                };\n\n                optionsPrepare(this._options);\n            }\n\n            if (typeof value !== 'undefined') {\n                this._options[ name ] = value;\n                optionsPrepare(this._options);\n\n            } else {\n                return this._options[ name ];\n            }\n        }\n    },\n\n    items: {\n        get: function () {\n            return bubbleset.getBubbles(this);\n        }\n    },\n\n    setContent: {\n        value: function (data) {\n            return this.editor.setContent(data);\n        }\n    },\n\n    addBubble: {\n        value: function (bubbleText, data) {\n            return this.editor.addBubble(bubbleText, data);\n        }\n    },\n\n    removeBubble: {\n        value: function (nodeBubble) {\n            return this.editor.removeBubble(nodeBubble);\n        }\n    },\n\n    editBubble: {\n        value: function (nodeBubble) {\n            return this.editor.editBubble(nodeBubble);\n        }\n    }\n});\n\nmodule.exports = context.document.registerElement('x-bubbles', {\n    extends: 'div',\n    prototype: XBubbles\n});\n\nconst OPTIONS_PREPARE = {\n    funk: function (value) {\n        const type = typeof value;\n        switch (type) {\n        case 'string':\n            return new Function('context', `return context.${value};`)(context);\n\n        case 'function':\n            return value;\n        }\n    },\n    bool: function (value) {\n        const type = typeof value;\n        switch (type) {\n        case 'string':\n            return (value === 'true' || value === 'on');\n\n        case 'boolean':\n            return value;\n        }\n    },\n    noop: function (value) {\n        return value;\n    },\n};\n\nfunction optionsPrepare(options) {\n    for (let name in OPTIONS) {\n        const [ type, def ] = OPTIONS[ name ];\n        options[ name ] = OPTIONS_PREPARE[ type ](options[ name ]);\n        if (typeof options[ name ] === 'undefined') {\n            options[ name ] = def;\n        }\n    }\n}\n\nfunction initEditor(node) {\n    if (!node.editor) {\n        Object.defineProperty(node, 'editor', {\n            configurable: true,\n            value: editor.init(node)\n        });\n    }\n}\n\nfunction destroyEditor(node) {\n    if (node.editor) {\n        editor.destroy(node);\n        delete node.editor;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","module.exports = (function () {\n    /* eslint no-eval: 0 */\n    return this || (1, eval)('this');\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./context.js\n **/","const native = require('./drag/native');\nconst mouse = require('./drag/mouse');\nconst { canUseDrag } = require('./utils');\n\nexports.init = function (nodeSet) {\n    if (canUseDrag()) {\n        return native.init(nodeSet);\n    }\n\n    return mouse.init(nodeSet);\n};\n\nexports.destroy = function (nodeSet) {\n    if (canUseDrag()) {\n        return native.destroy(nodeSet);\n    }\n\n    return mouse.destroy(nodeSet);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/drag.js\n **/","const context = require('../../context');\nconst select = require('../select');\nconst bubbleset = require('../bubbleset');\nconst events = require('../events');\nconst { CLS } = require('../constant');\nconst { getDragImage, onDropSuccess, DRAG_IMG_WIDTH } = require('./common');\n\nconst EVENTS = {\n    dragend: onDragend,\n    dragenter: onDragenter,\n    dragleave: onDragleave,\n    dragover: onDragover,\n    dragstart: onDragstart,\n    drop: onDrop,\n};\n\nlet currentDragSet = null;\n\nexports.init = function (nodeSet) {\n    events.on(nodeSet, EVENTS);\n};\n\nexports.destroy = function (nodeSet) {\n    events.off(nodeSet, EVENTS);\n};\n\nfunction onDragstart(event) {\n    event.stopPropagation();\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (!nodeSet || !nodeBubble) {\n        event.preventDefault();\n        return;\n    }\n\n    const selection = context.getSelection();\n    selection && selection.removeAllRanges();\n\n    currentDragSet = nodeSet;\n    nodeSet.classList.add(CLS.DRAGSTART);\n    select.add(nodeBubble);\n\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/plain', '');\n\n    const list = select.get(currentDragSet);\n    if (list.length > 1) {\n        event.dataTransfer.setDragImage(getDragImage(), DRAG_IMG_WIDTH, DRAG_IMG_WIDTH);\n    }\n}\n\nfunction onDrop(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet || nodeSet === currentDragSet) {\n        return;\n    }\n\n    const list = select.get(currentDragSet);\n\n    if (list.length) {\n        list.forEach(item => nodeSet.appendChild(item));\n        context.setTimeout(onDropSuccess, 0, currentDragSet, nodeSet);\n    }\n}\n\nfunction onDragover(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    event.dataTransfer.dropEffect = 'move';\n}\n\nfunction onDragenter(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    if (nodeSet && nodeSet !== currentDragSet) {\n        nodeSet.classList.add(CLS.DROPZONE);\n    }\n}\n\nfunction onDragleave(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    if (nodeSet && nodeSet !== currentDragSet) {\n        nodeSet.classList.remove(CLS.DROPZONE);\n    }\n}\n\nfunction onDragend(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    currentDragSet.classList.remove(CLS.DRAGSTART);\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (nodeSet && nodeSet !== currentDragSet) {\n        nodeSet.classList.remove(CLS.DROPZONE);\n    }\n\n    currentDragSet = null;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/drag/native.js\n **/","const context = require('../context');\nconst bubble = require('./bubble');\nconst bubbleset = require('./bubbleset');\n\nconst slice = Array.prototype.slice;\nconst PATH_SELECTED = '[bubble][selected]';\nconst PATH_NOT_SELECTED = '[bubble]:not([selected])';\n\nexports.all = all;\nexports.add = add;\nexports.clear = clear;\nexports.get = get;\nexports.uniq = uniq;\nexports.head = head;\nexports.last = last;\nexports.has = has;\nexports.range = range;\nexports.toggleUniq = toggleUniq;\n\nfunction range(node) {\n    if (!bubble.isBubbleNode(node)) {\n        return;\n    }\n\n    const set = node.parentNode;\n    const list = get(set);\n\n    if (!list.length) {\n        uniq(node);\n        return;\n    }\n\n    clear(set);\n\n    const headList = list[0];\n    const lastList = list[ list.length - 1 ];\n\n    if (headList === lastList || !set.startRangeSelect) {\n        set.startRangeSelect = headList;\n    }\n\n    let fromNode;\n    let toNode;\n    const position = node.compareDocumentPosition(set.startRangeSelect);\n\n    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n        fromNode = set.startRangeSelect;\n        toNode = node;\n\n    } else {\n        fromNode = node;\n        toNode = set.startRangeSelect;\n    }\n\n    if (fromNode && toNode) {\n        let item = fromNode;\n\n        while (item) {\n            if (!setSelected(item)) {\n                break;\n            }\n\n            if (item === toNode) {\n                break;\n            }\n\n            item = item.nextSibling;\n        }\n\n        bubble.bubbling(set);\n    }\n}\n\nfunction all(nodeSet) {\n    slice.call(nodeSet.querySelectorAll(PATH_NOT_SELECTED)).forEach(item => setSelected(item));\n    nodeSet.startRangeSelect = nodeSet.querySelector(PATH_SELECTED);\n\n    bubble.bubbling(nodeSet);\n\n    const selection = context.getSelection();\n    selection && selection.removeAllRanges();\n}\n\nfunction has(nodeSet) {\n    return Boolean(nodeSet.querySelector(PATH_SELECTED));\n}\n\nfunction head(set) {\n    return get(set)[0];\n}\n\nfunction last(set) {\n    const list = get(set);\n    return list[ list.length - 1 ];\n}\n\nfunction get(nodeSet) {\n    return slice.call(nodeSet.querySelectorAll(PATH_SELECTED));\n}\n\nfunction clear(nodeSet) {\n    get(nodeSet).forEach(item => item.removeAttribute('selected'));\n}\n\nfunction add(node) {\n    if (setSelected(node)) {\n        const nodeSet = bubbleset.closestNodeSet(node);\n\n        nodeSet.startRangeSelect = node;\n        // ???\n        bubble.bubbling(nodeSet);\n\n        return true;\n    }\n\n    return false;\n}\n\nfunction uniq(node) {\n    if (!bubble.isBubbleNode(node)) {\n        return false;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(node);\n    const selection = context.getSelection();\n\n    selection && selection.removeAllRanges();\n    clear(nodeSet);\n\n    return add(node);\n}\n\nfunction toggleUniq(node) {\n    if (isSelected(node)) {\n        const nodeSet = bubbleset.closestNodeSet(node);\n\n        if (get(nodeSet).length === 1) {\n            return removeSelected(node);\n        }\n    }\n\n    return uniq(node);\n}\n\nfunction isSelected(node) {\n    return bubble.isBubbleNode(node) && node.hasAttribute('selected') || false;\n}\n\nfunction setSelected(node) {\n    if (bubble.isBubbleNode(node)) {\n        node.setAttribute('selected', '');\n        return true;\n    }\n\n    return false;\n}\n\nfunction removeSelected(node) {\n    if (bubble.isBubbleNode(node)) {\n        node.removeAttribute('selected');\n        return true;\n    }\n\n    return false;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/select.js\n **/","const context = require('../context');\nconst text = require('./text');\nconst { escape, canUseDrag } = require('./utils');\n\nexports.isBubbleNode = isBubbleNode;\nexports.bubbling = bubbling;\nexports.create = create;\nexports.edit = edit;\n\nfunction isBubbleNode(node) {\n    if (!node || node.nodeType !== Node.ELEMENT_NODE) {\n        return false;\n    }\n\n    return node.hasAttribute('bubble');\n}\n\nfunction edit(nodeSet, nodeBubble) {\n    if (nodeBubble.hasAttribute('readonly')) {\n        return false;\n    }\n\n    const selection = context.getSelection();\n\n    if (!selection) {\n        return false;\n    }\n\n    const bubbleDeformation = nodeSet.options('bubbleDeformation');\n    let rangeParams = bubbleDeformation(nodeBubble);\n\n    if (!rangeParams) {\n        const dataText = text.textClean(nodeBubble.innerText);\n\n        rangeParams = {\n            text: dataText,\n            startOffset: 0,\n            endOffset: dataText.length\n        };\n    }\n\n    const textFake = text.createZws();\n    const textNode = context.document.createTextNode(rangeParams.text);\n\n    nodeSet.fireEdit(nodeBubble);\n    nodeSet.replaceChild(textNode, nodeBubble);\n    nodeSet.insertBefore(textFake, textNode);\n\n    const range = context.document.createRange();\n    range.setStart(textNode, rangeParams.startOffset);\n    range.setEnd(textNode, rangeParams.endOffset);\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n    return true;\n}\n\nfunction create(nodeSet, dataText, data = {}) {\n    dataText = text.textClean(dataText);\n\n    if (!dataText) {\n        return;\n    }\n\n    const bubbleFormation = nodeSet.options('bubbleFormation');\n    const classBubble = nodeSet.options('classBubble');\n    const draggable = canUseDrag() && nodeSet.options('draggable');\n    const wrap = context.document.createElement('span');\n\n    wrap.innerText = dataText;\n\n    if (draggable) {\n        wrap.setAttribute('draggable', 'true');\n    }\n\n    for (let key in data) {\n        if (data[ key ]) {\n            wrap.setAttribute(`data-${key}`, escape(data[ key ]));\n        }\n    }\n\n    bubbleFormation(wrap);\n\n    if (classBubble) {\n        const classes = String(classBubble).trim().split(/\\s+/);\n        let len = classes.length;\n\n        while (len--) {\n            wrap.classList.add(classes[ len ]);\n        }\n    }\n\n    wrap.setAttribute('bubble', '');\n    wrap.setAttribute('contenteditable', 'false');\n\n    return wrap;\n}\n\nfunction bubbling(nodeSet) {\n    const separator = nodeSet.options('separator');\n    const ending = nodeSet.options('ending');\n    const begining = nodeSet.options('begining');\n    const ranges = getBubbleRanges(nodeSet);\n    const nodes = [];\n\n    ranges.forEach(function (range) {\n        const dataText = text.textClean(range.toString());\n\n        if (!dataText) {\n            range.deleteContents();\n            return;\n        }\n\n        let textParts = [ dataText ];\n\n        if (separator) {\n            textParts = dataText\n                .split(separator)\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n        }\n\n        if (ending) {\n            textParts = textParts\n                .reduce((parts, str) => parts.concat(parseFragmentByEnding(str, ending)), [])\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n\n        } else if (begining) {\n            textParts = textParts\n                .reduce((parts, str) => parts.concat(parseFragmentByBeginning(str, begining)), [])\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n        }\n\n        if (!textParts.length) {\n            range.deleteContents();\n        }\n\n        const fragment = context.document.createDocumentFragment();\n\n        textParts.forEach(function (textPart) {\n            const nodeBubble = create(nodeSet, textPart);\n            if (nodeBubble) {\n                fragment.appendChild(nodeBubble);\n                nodes.push(nodeBubble);\n            }\n        });\n\n        range.deleteContents();\n        range.insertNode(fragment);\n    });\n\n    nodeSet.fireInput();\n\n    if (nodes.length) {\n        nodeSet.fireChange();\n    }\n\n    return nodes;\n}\n\nfunction getBubbleRanges(nodeSet) {\n    const ranges = [];\n    const children = nodeSet.childNodes;\n    let range;\n    let node;\n\n    for (let i = 0; i < children.length; i++) {\n        node = children[ i ];\n\n        if (isBubbleNode(node)) {\n            if (range) {\n                range.setEndBefore(node);\n                ranges.push(range);\n                range = undefined;\n            }\n\n        } else {\n            if (!range) {\n                range = context.document.createRange();\n                range.setStartBefore(node);\n            }\n        }\n    }\n\n    if (range) {\n        range.setEndAfter(node);\n        ranges.push(range);\n    }\n\n    return ranges;\n}\n\nfunction trimIterator(str) {\n    return str.trim();\n}\n\nfunction nonEmptyIterator(str) {\n    return Boolean(str);\n}\n\nfunction parseFragmentByEnding(str, reg) {\n    const parts = [];\n    let lastIndex = 0;\n    let loop = 999;\n\n    reg.lastIndex = 0;\n    while (reg.exec(str) !== null && loop) {\n        loop--;\n        parts.push(str.substring(lastIndex, reg.lastIndex));\n        lastIndex = reg.lastIndex;\n    }\n\n    return parts;\n}\n\nfunction parseFragmentByBeginning(str, reg) {\n    const parts = [];\n    let res;\n    let index = 0;\n    let loop = 999;\n\n    reg.lastIndex = 0;\n    while ((res = reg.exec(str)) !== null && loop) {\n        loop--;\n        if (index !== res.index) {\n            parts.push(str.substring(index, res.index));\n            index = res.index;\n        }\n    }\n\n    parts.push(str.substring(index, str.length));\n    return parts;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/bubble.js\n **/","const context = require('../context');\nconst bubble = require('./bubble');\nconst bubbleset = require('./bubbleset');\n\n/* eslint-disable max-len */\nconst REG_REPLACE_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\nconst REG_ZWS = /\\u200B/;\nconst TEXT_ZWS = '\\u200B';\n\nexports.arrowRight = arrowRight;\nexports.arrowLeft = arrowLeft;\nexports.remove = remove;\nexports.html2text = html2text;\nexports.currentTextRange = currentTextRange;\nexports.text2bubble = text2bubble;\nexports.replaceString = replaceString;\nexports.selectAll = selectAll;\nexports.textClean = textClean;\nexports.checkZws = checkZws;\nexports.createZws = createZws;\n\nfunction text2bubble(nodeSet, nodeBubble, selection) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return false;\n    }\n\n    const range = currentTextRange(selection);\n\n    if (range && !nodeBubble) {\n        nodeBubble = bubble.create(nodeSet, range.toString());\n    }\n\n    if (!nodeBubble) {\n        return false;\n    }\n\n    if (range) {\n        selection.removeAllRanges();\n        selection.addRange(range);\n        replace(selection, nodeBubble);\n\n    } else {\n        nodeSet.appendChild(nodeBubble);\n    }\n\n    return true;\n}\n\nfunction currentTextRange(selection) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return;\n    }\n\n    const pointNode = do {\n        if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n            selection.focusNode;\n\n        } else if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n            selection.anchorNode;\n\n        } else {\n            undefined;\n        }\n    };\n\n    if (!pointNode) {\n        return;\n    }\n\n    const range = context.document.createRange();\n    let startNode = pointNode;\n    let endNode = pointNode;\n    let item = pointNode;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        startNode = item;\n        item = item.previousSibling;\n    }\n\n    item = pointNode;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        endNode = item;\n        item = item.nextSibling;\n    }\n\n    range.setStartBefore(startNode);\n    range.setEndAfter(endNode);\n\n    return range;\n}\n\nfunction remove(selection) {\n    return replace(selection, createZws());\n}\n\nfunction replace(selection, node) {\n    selection = selection || context.getSelection();\n\n    if (!selection || !selection.rangeCount) {\n        return false;\n    }\n\n    const anchor = context.document.createElement('span');\n    selection.getRangeAt(0).surroundContents(anchor);\n    anchor.parentNode.replaceChild(node, anchor);\n\n    selection.removeAllRanges();\n    selection.collapse(node, 0);\n\n    return true;\n}\n\nfunction replaceString(data, selection) {\n    data = textClean(data);\n    if (!data) {\n        return false;\n    }\n\n    selection = selection || context.getSelection();\n    const textNode = context.document.createTextNode(data);\n\n    if (!replace(selection, textNode)) {\n        return false;\n    }\n\n    selection.collapse(textNode, textNode.nodeValue.length);\n    return true;\n}\n\nfunction arrowLeft(selection, extend) {\n    selection = selection || context.getSelection();\n\n    if (!selection ||\n        !selection.anchorNode ||\n        selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\n        return false;\n    }\n\n    let { startNode, endNode, startOffset, endOffset, revert } = selectionCorrect(selection);\n\n    if (!selection.isCollapsed && !extend) {\n        selection.collapse(startNode, startOffset);\n        return true;\n    }\n\n    const isNativeExtend = Boolean(selection.extend);\n    revert = isNativeExtend ? revert : !revert;\n    let node = revert ? startNode : endNode;\n    let offset = revert ? startOffset : endOffset;\n\n    while (node) {\n        if (node.nodeType !== Node.TEXT_NODE) {\n            return false;\n        }\n\n        if (offset === null) {\n            offset = node.nodeValue.length;\n        }\n\n        if (offset - 1 < 0) {\n            node = node.previousSibling;\n            offset = null;\n            continue;\n        }\n\n        const text = node.nodeValue.substring(offset - 1, offset);\n\n        if (checkZws(text)) {\n            offset = offset - 1;\n            continue;\n        }\n\n        break;\n    }\n\n    if (!node || offset === null) {\n        return false;\n    }\n\n    if (extend) {\n        if (isNativeExtend) {\n            selection.extend(node, offset - 1);\n\n        } else {\n            const range = context.document.createRange();\n\n            if (revert) {\n                range.setStart(node, offset - 1);\n                range.setEnd(endNode, endOffset);\n\n            } else {\n                range.setStart(startNode, startOffset);\n                range.setEnd(node, offset - 1);\n            }\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n\n    } else {\n        selection.collapse(node, offset - 1);\n    }\n\n    return true;\n}\n\nfunction arrowRight(selection, extend) {\n    selection = selection || context.getSelection();\n\n    if (!selection ||\n        !selection.focusNode ||\n        selection.focusNode.nodeType !== Node.TEXT_NODE) {\n\n        return false;\n    }\n\n    let { startNode, endNode, startOffset, endOffset, revert } = selectionCorrect(selection);\n\n    if (!selection.isCollapsed && !extend) {\n        selection.collapse(endNode, endOffset);\n        return true;\n    }\n\n    let node = revert ? startNode : endNode;\n    let offset = revert ? startOffset : endOffset;\n\n    while (node) {\n        if (node.nodeType !== Node.TEXT_NODE) {\n            return false;\n        }\n\n        const len = node.nodeValue.length;\n\n        if (offset + 1 > len) {\n            node = node.nextSibling;\n            offset = 0;\n            continue;\n        }\n\n        const text = node.nodeValue.substring(offset, offset + 1);\n\n        if (checkZws(text)) {\n            offset = offset + 1;\n            continue;\n        }\n\n        break;\n    }\n\n    if (!node) {\n        return false;\n    }\n\n    if (extend) {\n        const isNativeExtend = Boolean(selection.extend);\n\n        if (isNativeExtend) {\n            selection.extend(node, offset + 1);\n\n        } else {\n            const range = context.document.createRange();\n\n            if (revert) {\n                range.setStart(node, offset + 1);\n                range.setEnd(endNode, endOffset);\n\n            } else {\n                range.setStart(startNode, startOffset);\n                range.setEnd(node, offset + 1);\n            }\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n\n    } else {\n        selection.collapse(node, offset + 1);\n    }\n\n    return true;\n}\n\nfunction html2text(value) {\n    if (!value) {\n        return '';\n    }\n\n    var DOMContainer = context.document.implementation.createHTMLDocument('').body;\n    DOMContainer.innerText = value;\n\n    return DOMContainer.innerText\n        .replace(/^[\\u0020\\u00a0]+$/gm, '')\n        .replace(/\\n/gm, ' ')\n        .trim();\n}\n\nfunction selectAll(selection, nodeSet) {\n    selection = selection || context.getSelection();\n    const node = selection && selection.anchorNode;\n\n    if (!node || node.nodeType !== Node.TEXT_NODE) {\n        return false;\n    }\n\n    let fromNode;\n    let toNode;\n    let item = node;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        fromNode = item;\n        item = item.previousSibling;\n    }\n\n    item = node;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        toNode = item;\n        item = item.nextSibling;\n    }\n\n    const hasBubbles = bubbleset.hasBubbles(nodeSet);\n    const range = context.document.createRange();\n    range.setStartBefore(fromNode);\n    range.setEndAfter(toNode);\n\n    const dataText = textClean(range.toString());\n\n    if (dataText || (!dataText && !hasBubbles)) {\n        if (!dataText) {\n            range.collapse();\n        }\n\n        selection.removeAllRanges();\n        selection.addRange(range);\n        return true;\n    }\n\n    return false;\n}\n\nfunction createZws() {\n    return context.document.createTextNode(TEXT_ZWS);\n}\n\nfunction checkZws(value) {\n    return REG_ZWS.test(value);\n}\n\nfunction textClean(value) {\n    return String(value || '')\n        .trim()\n        .replace(REG_REPLACE_NON_PRINTABLE, '');\n}\n\nfunction selectionCorrect(selection) {\n    let startNode = selection.anchorNode;\n    let endNode = selection.focusNode;\n    let startOffset = selection.anchorOffset;\n    let endOffset = selection.focusOffset;\n    let revert = false;\n\n    if (startNode === endNode) {\n        startOffset = Math.min(selection.anchorOffset, selection.focusOffset);\n        endOffset = Math.max(selection.anchorOffset, selection.focusOffset);\n        revert = selection.anchorOffset > selection.focusOffset;\n\n    } else {\n        const position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n        if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n            startNode = selection.focusNode;\n            startOffset = selection.focusOffset;\n            endNode = selection.anchorNode;\n            endOffset = selection.anchorOffset;\n            revert = true;\n        }\n    }\n\n    return { startNode, endNode, startOffset, endOffset, revert };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/text.js\n **/","const bubble = require('./bubble');\nconst text = require('./text');\n\nexports.closestNodeBubble = closestNodeBubble;\nexports.closestNodeSet = closestNodeSet;\nexports.findBubbleLeft = findBubbleLeft;\nexports.getBubbles = getBubbles;\nexports.hasBubbles = hasBubbles;\nexports.headBubble = headBubble;\nexports.lastBubble = lastBubble;\nexports.nextBubble = nextBubble;\nexports.prevBubble = prevBubble;\n\nfunction lastBubble(nodeSet) {\n    return nodeSet.querySelector('[bubble]:last-child');\n}\n\nfunction headBubble(nodeSet) {\n    return nodeSet.querySelector('[bubble]:first-child');\n}\n\nfunction getBubbles(nodeSet) {\n    return Array.prototype.slice.call(nodeSet.querySelectorAll('[bubble]'));\n}\n\nfunction hasBubbles(nodeSet) {\n    return Boolean(nodeSet.querySelector('[bubble]'));\n}\n\nfunction findBubbleLeft(selection) {\n    if (!selection.focusNode || !selection.anchorNode) {\n        return;\n    }\n\n    let node = selection.focusNode.previousSibling;\n\n    if (selection.anchorNode !== selection.focusNode &&\n        selection.anchorNode.compareDocumentPosition(selection.focusNode) & Node.DOCUMENT_POSITION_FOLLOWING) {\n        node = selection.anchorNode.previousSibling;\n    }\n\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        if (node.nodeType === Node.TEXT_NODE && text.textClean(node.nodeValue)) {\n            return;\n        }\n\n        node = node.previousSibling;\n    }\n}\n\nfunction closestNodeSet(node) {\n    while (node) {\n        if (node.nodeType === Node.ELEMENT_NODE &&\n            node.getAttribute('is') === 'x-bubbles') {\n\n            return node;\n        }\n\n        node = node.parentNode;\n    }\n}\n\nfunction closestNodeBubble(node) {\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.parentNode;\n    }\n}\n\nfunction prevBubble(target) {\n    let node = target && target.previousSibling;\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.previousSibling;\n    }\n}\n\nfunction nextBubble(target) {\n    let node = target && target.nextSibling;\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.nextSibling;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/bubbleset.js\n **/","const raf = require('raf');\nconst context = require('../context');\n\n/* eslint quotes: 0 */\n\nconst HTML_ESCAPES = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '`': '&#96;'\n};\n\nconst HTML_UNESCAPES = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\",\n    '&#96;': '`'\n};\n\nconst REG_ESCAPED_HTML = /&(?:amp|lt|gt|quot|#39|#96);/g;\nconst REG_UNESCAPED_HTML = /[&<>\"'`]/g;\nconst REG_HAS_ESCAPED_HTML = RegExp(REG_ESCAPED_HTML.source);\nconst REG_HAS_UNESCAPED_HTML = RegExp(REG_UNESCAPED_HTML.source);\nconst REG_IE = /Trident|Edge/;\n\nexports.throttle = function (callback) {\n    let throttle = 0;\n    const animationCallback = function () {\n        throttle = 0;\n    };\n\n    return function () {\n        if (throttle) {\n            return;\n        }\n\n        throttle = raf(animationCallback);\n\n        callback.apply(this, arguments);\n    };\n};\n\nexports.escape = function (data) {\n    data = String(data);\n\n    if (data && REG_HAS_UNESCAPED_HTML.test(data)) {\n        return data.replace(REG_UNESCAPED_HTML, escapeHtmlChar);\n    }\n\n    return data;\n};\n\n\nexports.unescape = function (data) {\n    data = String(data);\n\n    if (data && REG_HAS_ESCAPED_HTML.test(data)) {\n        return data.replace(REG_ESCAPED_HTML, unescapeHtmlChar);\n    }\n\n    return data;\n};\n\nexports.canUseDrag = function () {\n    return !REG_IE.test(context.navigator.userAgent);\n};\n\nfunction unescapeHtmlChar(chr) {\n    return HTML_UNESCAPES[ chr ];\n}\n\nfunction escapeHtmlChar(chr) {\n    return HTML_ESCAPES[ chr ];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/utils.js\n **/","var now = require('performance-now')\n  , root = typeof window === 'undefined' ? global : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = root['request' + suffix]\n  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\nfor(var i = 0; !raf && i < vendors.length; i++) {\n  raf = root[vendors[i] + 'Request' + suffix]\n  caf = root[vendors[i] + 'Cancel' + suffix]\n      || root[vendors[i] + 'CancelRequest' + suffix]\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  var last = 0\n    , id = 0\n    , queue = []\n    , frameDuration = 1000 / 60\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = now()\n        , next = Math.max(0, frameDuration - (_now - last))\n      last = next + _now\n      setTimeout(function() {\n        var cp = queue.slice(0)\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last)\n            } catch(e) {\n              setTimeout(function() { throw e }, 0)\n            }\n          }\n        }\n      }, Math.round(next))\n    }\n    queue.push({\n      handle: ++id,\n      callback: callback,\n      cancelled: false\n    })\n    return id\n  }\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true\n      }\n    }\n  }\n}\n\nmodule.exports = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  return raf.call(root, fn)\n}\nmodule.exports.cancel = function() {\n  caf.apply(root, arguments)\n}\nmodule.exports.polyfill = function() {\n  root.requestAnimationFrame = raf\n  root.cancelAnimationFrame = caf\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/raf/index.js\n ** module id = 9\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.7.1\n(function() {\n  var getNanoSeconds, hrtime, loadTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - loadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    loadTime = getNanoSeconds();\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/performance-now/lib/performance-now.js\n ** module id = 10\n ** module chunks = 0\n **/","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/process/browser.js\n ** module id = 11\n ** module chunks = 0\n **/","/**\n * @module x-bubbles/event\n */\n\nconst context = require('../context');\nconst CustomEventCommon = require('../polyfills/CustomEventCommon');\n\nexports.scrollX = scrollX;\nexports.scrollY = scrollY;\nexports.dispatch = dispatch;\n\nexports.keyCode = function (event) {\n    return event.charCode || event.keyCode;\n};\n\nexports.metaKey = function (event) {\n    return event.ctrlKey || event.metaKey;\n};\n\nexports.pageX = function (event) {\n    return (event.pageX === null && event.clientX !== null) ?\n        event.clientX + scrollX() :\n        event.pageX;\n};\n\nexports.pageY = function (event) {\n    return (event.pageY === null && event.clientY !== null) ?\n        event.clientY + scrollY() :\n        event.pageY;\n};\n\nexports.one = function (target, eventName, callback) {\n    const events = callback ? { [ eventName ]: callback } : eventName;\n    for (const name in events) {\n        target.addEventListener(name, oneCallback(target, name, events[ name ]));\n    }\n};\n\nexports.on = function (target, eventName, callback) {\n    const events = callback ? { [ eventName ]: callback } : eventName;\n    for (const name in events) {\n        target.addEventListener(name, events[ name ]);\n    }\n};\n\nexports.off = function (target, eventName, callback) {\n    const events = callback ? { [ eventName ]: callback } : eventName;\n    for (const name in events) {\n        target.removeEventListener(name, events[ name ]);\n    }\n};\n\nexports.prevent = function (event) {\n    event.cancelBubble = true;\n    event.returnValue = false;\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n    event.preventDefault();\n    return false;\n};\n\nfunction scrollX() {\n    const html = context.document.documentElement;\n    const body = context.document.body;\n    return (html && html.scrollLeft || body && body.scrollLeft || 0) - (html.clientLeft || 0);\n}\n\nfunction scrollY() {\n    const html = context.document.documentElement;\n    const body = context.document.body;\n    return (html && html.scrollTop || body && body.scrollTop || 0) - (html.clientTop || 0);\n}\n\n/**\n * Designer events.\n *\n * @example\n * const { Custom } = require('event');\n *\n * new Custom('custom-event', {\n *     bubbles: true,\n *     cancelable: true,\n *     detail: { data: '123' }\n * })\n *\n * @alias module:x-bubbles/event~Custom\n * @constructor\n */\nconst Custom = (function () {\n    if (typeof context.CustomEvent === 'function') {\n        return context.CustomEvent;\n    }\n\n    return CustomEventCommon;\n}());\n\n/**\n * Dispatch event.\n *\n * @example\n * const { dispatch } = require('event');\n * dispatch(node, 'custom-event', {\n *     bubbles: true,\n *     cancelable: true,\n *     detail: { data: '123' }\n * })\n *\n * @alias module:x-bubbles/event.dispatch\n * @param {HTMLElement} element node events\n * @param {string} name event name\n * @param {Object} params the event parameters\n * @param {boolean} [params.bubbles=false]\n * @param {boolean} [params.cancelable=false]\n * @param {*} [params.detail]\n */\nfunction dispatch(element, name, params = {}) {\n    element.dispatchEvent(new Custom(name, params));\n}\n\nfunction oneCallback(target, eventName, callback) {\n    return function _callback(event) {\n        target.removeEventListener(eventName, _callback);\n        callback(event);\n    };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events.js\n **/","const context = require('../context');\n\n/**\n * @constant {Document}\n * @private\n */\nconst doc = context.document;\n\n/**\n * @constant {Object}\n * @private\n */\nconst protoEvent = context.Event.prototype;\n\nlet issetCustomEvent = false;\n\ntry {\n    issetCustomEvent = Boolean(doc.createEvent('CustomEvent'));\n} catch (e) {\n    // do nothing\n}\n\n/**\n * The original function \"stopImmediatePropagation\"\n * @constant {function}\n * @private\n */\nconst stopImmediatePropagation = protoEvent.stopImmediatePropagation;\n\n/**\n * Override function to set properties \"immediatePropagationStopped\"\n */\nprotoEvent.stopImmediatePropagation = function () {\n    this.immediatePropagationStopped = true;\n\n    if (stopImmediatePropagation) {\n        stopImmediatePropagation.call(this);\n\n    } else {\n        this.stopPropagation();\n    }\n};\n\nlet CustomEventCommon = (function () {\n    if (issetCustomEvent) {\n        return function (eventName, params) {\n            params = params || {};\n\n            let bubbles = Boolean(params.bubbles);\n            let cancelable = Boolean(params.cancelable);\n            let evt = doc.createEvent('CustomEvent');\n\n            evt.initCustomEvent(eventName, bubbles, cancelable, params.detail);\n\n            return evt;\n        };\n    }\n\n    return function (eventName, params) {\n        params = params || {};\n\n        let bubbles = Boolean(params.bubbles);\n        let cancelable = Boolean(params.cancelable);\n        let evt = doc.createEvent('Event');\n\n        evt.initEvent(eventName, bubbles, cancelable);\n        evt.detail = params.detail;\n\n        return evt;\n    };\n}());\n\nCustomEventCommon.prototype = protoEvent;\n\nmodule.exports = CustomEventCommon;\n\n\n\n/** WEBPACK FOOTER **\n ** ./polyfills/CustomEventCommon.js\n **/","exports.KEY = {\n    a: 65,\n    c: 67,\n    Backspace: 8,\n    Bottom: 40,\n    Cmd: 91,\n    Comma: 44, // ,\n    Enter: 13, // Enter\n    Esc: 27,\n    Left: 37,\n    Right: 39,\n    Semicolon: 59, // ;\n    Space: 32,\n    Tab: 9,\n    Top: 38,\n};\n\nexports.CLS = {\n    DRAGSTART: 'drag',\n    DROPZONE: 'dropzone',\n};\n\nexports.EV = {\n    BUBBLE_EDIT: 'bubble-edit',\n    BUBBLE_INPUT: 'bubble-input',\n    CHANGE: 'change',\n    DRAGEND: 'dragend',\n    DRAGENTER: 'dragenter',\n    DRAGLEAVE: 'dragleave',\n    DRAGSTART: 'dragstart',\n    DROP: 'drop',\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/constant.js\n **/","const DRAG_IMG_WIDTH = 16;\n\nlet dragImage = null;\n\nexports.DRAG_IMG_WIDTH = DRAG_IMG_WIDTH;\n\nexports.getDragImage = function () {\n    if (!dragImage) {\n        dragImage = new Image();\n        dragImage.src = require('url?mimetype=image/png!./bubbles.png');\n    }\n\n    return dragImage;\n};\n\nexports.onDropSuccess = function (fromNodeSet, toNodeSet) {\n    fromNodeSet.fireChange();\n    toNodeSet.focus();\n    toNodeSet.fireChange();\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/drag/common.js\n **/","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB3klEQVR4XtWWMWgTYRTH/0n0IjWNkSo9jYJTx4KDAXWoIChtqdBFkG6lTm5iiw5OHQQFV4fSunYTOpVucbRDBicVUmmb0GsuJCYGknjfez4+PmjUy8U7cegffty3vPfjfY/jLsbM+J+JC8dbcAIm97aqEwBeCjmEywdhaePOSD5QQETr1y6m7Ww6iTApNTq57XJjHcCFYIEiGyeTKLYQKkmp0bWDrkiRQstD6HikazFYoBQIEWJql9+Ncu9Ons86+d8EBOKoAsLtG9P67FTLuY+fC3onf0zgcfQJKu1tfbaGU2Bm2+eKvKgTmFpdjK5qgtlnB17kHZjanq5M7LvkkltvZs+khxEm3xpNDCUqvwjIX0ALX4o7bwHYAs6fG8HlS1ns7ZdQcavol9NWHVNjb6COBP5XVJgf3+x9G8dXCuwpguu6eDrxAINCjIAJfFCk4Bw6eHZrLvTy+W8EpAiPrt6HYgth0qx1wcylgYKZobuTu59gduKfs6OnYF9J4eDrd9ScNkwOhAWY/NMXbXEtwxmR1KX5q/l6LOB7EAnd9MlqhhGQWM8zLiSM1IC4pn9uCtcfr6QXXz9svADwXsgLnqAEFgE0prklJA2WkSSEWICEDD+ErtAR2jCS4/9X8RPiO+YqXEJbcwAAAABJRU5ErkJggg==\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/url-loader?mimetype=image/png!./core/drag/bubbles.png\n ** module id = 16\n ** module chunks = 0\n **/","const context = require('../../context');\nconst events = require('../events');\nconst utils = require('../utils');\nconst select = require('../select');\nconst bubbleset = require('../bubbleset');\nconst Modernizr = require('modernizr');\nconst { CLS, EV } = require('../constant');\nconst { getDragImage, onDropSuccess, DRAG_IMG_WIDTH } = require('./common');\n\nlet currentDragSet = null;\nlet currentMoveSet = null;\nlet currentDragElement = null;\n\nexports.init = function (nodeSet) {\n    events.on(nodeSet, 'mousedown', onMousedown);\n};\n\nexports.destroy = function (nodeSet) {\n    events.off(nodeSet, 'mousedown', onMousedown);\n};\n\nfunction onMousedown(event) {\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n    if (!nodeBubble) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    if (!nodeSet) {\n        return;\n    }\n\n    event.preventDefault();\n    nodeSet.focus();\n\n    const drag = nodeSet.__drag__ = {\n        onMouseup: onMouseup.bind(this, nodeSet),\n        onMousemove: utils.throttle(onMousemove.bind(this, nodeSet)),\n        onScroll: utils.throttle(onScroll.bind(this, nodeSet)),\n        nodeOffsetX: event.offsetX,\n        nodeOffsetY: event.offsetY,\n        x: 0,\n        y: 0\n    };\n\n    currentDragSet = null;\n    currentMoveSet = null;\n    currentDragElement = null;\n\n    events.one(document, 'mouseup', drag.onMouseup);\n    events.on(document, 'mousemove', drag.onMousemove);\n    events.on(document, 'scroll', drag.onScroll);\n}\n\nfunction onMouseup(dragSet, event) {\n    const drag = dragSet.__drag__;\n    if (!drag) {\n        return;\n    }\n\n    events.off(document, 'mousemove', drag.onMousemove);\n    events.off(document, 'scroll', drag.onScroll);\n    delete dragSet.__drag__;\n\n    if (currentDragElement) {\n        currentDragElement.parentNode && currentDragElement.parentNode.removeChild(currentDragElement);\n        currentDragElement = null;\n    }\n\n    if (currentMoveSet) {\n        const _ = currentMoveSet;\n        currentMoveSet = null;\n\n        _.classList.remove(CLS.DROPZONE);\n        events.dispatch(_, EV.DRAGLEAVE, { bubbles: false, cancelable: false });\n    }\n\n    if (currentDragSet) {\n        const nodeSet = bubbleset.closestNodeSet(event.target);\n\n        if (nodeSet && nodeSet !== currentDragSet) {\n            const list = select.get(currentDragSet);\n\n            if (list.length) {\n                list.forEach(item => nodeSet.appendChild(item));\n                context.setTimeout(onDropSuccess, 0, currentDragSet, nodeSet);\n            }\n        }\n\n        const _ = currentDragSet;\n        currentDragSet = null;\n\n        _.classList.remove(CLS.DRAGSTART);\n        events.dispatch(_, EV.DROP, { bubbles: false, cancelable: false });\n        events.dispatch(_, EV.DRAGEND, { bubbles: false, cancelable: false });\n    }\n}\n\nfunction onMousemove(dragSet, event) {\n    const drag = dragSet.__drag__;\n    if (!drag) {\n        return;\n    }\n\n    if (!currentDragSet) {\n        const selection = context.getSelection();\n        selection && selection.removeAllRanges();\n\n        currentDragSet = dragSet;\n        currentDragSet.classList.add(CLS.DRAGSTART);\n\n        const nodeBubble = bubbleset.closestNodeBubble(event.target);\n        let moveElement;\n\n        if (nodeBubble) {\n            select.add(nodeBubble);\n            if (select.get(currentDragSet).length === 1) {\n                moveElement = nodeBubble.cloneNode(true);\n            }\n        }\n\n        if (!moveElement) {\n            moveElement = getDragImage();\n            drag.nodeOffsetX = DRAG_IMG_WIDTH;\n            drag.nodeOffsetY = DRAG_IMG_WIDTH;\n        }\n\n        currentDragElement = document.body.appendChild(document.createElement('div'));\n        currentDragElement.style.cssText = 'position:absolute;z-index:9999;pointer-events:none;top:0;left:0;';\n        currentDragElement.appendChild(moveElement);\n\n        events.dispatch(currentDragSet, EV.DRAGSTART, { bubbles: false, cancelable: false });\n    }\n\n    drag.x = event.clientX;\n    drag.y = event.clientY;\n    onScroll(dragSet);\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    if (nodeSet && nodeSet !== currentDragSet) {\n        if (currentMoveSet && currentMoveSet !== nodeSet) {\n            currentMoveSet.classList.remove(CLS.DROPZONE);\n            nodeSet.classList.add(CLS.DROPZONE);\n            currentMoveSet = nodeSet;\n            events.dispatch(currentMoveSet, EV.DRAGENTER, { bubbles: false, cancelable: false });\n\n        } else if (!currentMoveSet) {\n            nodeSet.classList.add(CLS.DROPZONE);\n            currentMoveSet = nodeSet;\n            events.dispatch(currentMoveSet, EV.DRAGENTER, { bubbles: false, cancelable: false });\n        }\n\n    } else if (currentMoveSet) {\n        const _ = currentMoveSet;\n        currentMoveSet = null;\n\n        _.classList.remove(CLS.DROPZONE);\n        events.dispatch(_, EV.DRAGLEAVE, { bubbles: false, cancelable: false });\n    }\n}\n\nfunction onScroll(dragSet) {\n    const drag = dragSet.__drag__;\n    if (!drag || !currentDragElement) {\n        return;\n    }\n\n    const x = drag.x - drag.nodeOffsetX + events.scrollX();\n    const y = drag.y - drag.nodeOffsetY + events.scrollY();\n\n    if (Modernizr.csstransforms3d) {\n        currentDragElement.style.transform = `translate3d(${x}px, ${y}px, 0px)`;\n\n    } else if (Modernizr.csstransforms) {\n        currentDragElement.style.transform = `translate(${x}px, ${y}px)`;\n\n    } else {\n        currentDragElement.style.top = `${y}px`;\n        currentDragElement.style.left = `${x}px`;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/drag/mouse.js\n **/","module.exports = Modernizr;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"var\":\"Modernizr\",\"root\":\"modernizr\",\"commonjs2\":\"modernizr\",\"commonjs\":\"modernizr\",\"amd\":\"modernizr\"}\n ** module id = 18\n ** module chunks = 0\n **/","const raf = require('raf');\nconst context = require('../context');\nconst bubbleset = require('./bubbleset');\nconst bubble = require('./bubble');\nconst cursor = require('./cursor');\nconst select = require('./select');\nconst { KEY, EV } = require('./constant');\nconst text = require('./text');\nconst events = require('./events');\nconst utils = require('./utils');\nconst copy = require('./editor/copy');\n\nconst EVENTS = {\n    blur: onBlur,\n    click: onClick,\n    dblclick: onDblclick,\n    focus: onFocus,\n    keydown: onKeydown,\n    keypress: onKeypress,\n    keyup: onKeyup,\n    mscontrolselect: events.prevent,\n    paste: onPaste,\n    resize: events.prevent,\n    resizestart: events.prevent,\n};\n\nexports.init = function (nodeEditor) {\n    nodeEditor.setAttribute('contenteditable', 'true');\n    nodeEditor.setAttribute('spellcheck', 'false');\n\n    nodeEditor.fireChange = utils.throttle(fireChange);\n    nodeEditor.fireEdit = utils.throttle(fireEdit);\n    nodeEditor.fireInput = utils.throttle(fireInput);\n\n    events.on(nodeEditor, EVENTS);\n\n    return {\n        addBubble: addBubble.bind(nodeEditor),\n        editBubble: editBubble.bind(nodeEditor),\n        removeBubble: removeBubble.bind(nodeEditor),\n        setContent: setContent.bind(nodeEditor),\n    };\n};\n\nexports.destroy = function (nodeEditor) {\n    events.off(nodeEditor, EVENTS);\n};\n\nfunction onBlur(event) {\n    const nodeEditor = event.currentTarget;\n    if (nodeEditor._lockCopy) {\n        return events.prevent(event);\n    }\n\n    select.clear(nodeEditor);\n    bubble.bubbling(nodeEditor);\n}\n\nfunction onFocus(event) {\n    const nodeEditor = event.currentTarget;\n    if (nodeEditor._lockCopy) {\n        events.prevent(event);\n        delete nodeEditor._lockCopy;\n\n        // Safary 10     \n        raf(() => {\n            const selection = context.getSelection();\n            selection && selection.removeAllRanges();\n        });\n\n        return false;\n    }\n\n    cursor.restore(nodeEditor);\n}\n\nfunction onKeyup(event) {\n    const nodeEditor = event.currentTarget;\n    const code = events.keyCode(event);\n    const isPrintableChar = do {\n        if (event.key) {\n            event.key.length === 1;\n\n        } else {\n            ((code > 47 || code === KEY.Space || code === KEY.Backspace) && code !== KEY.Cmd);\n        }\n    };\n\n    if (isPrintableChar) {\n        nodeEditor.fireInput();\n    }\n}\n\nfunction onKeypress(event) {\n    const code = events.keyCode(event);\n    const nodeEditor = event.currentTarget;\n\n    /* eslint no-case-declarations: 0 */\n    switch (code) {\n    case KEY.Enter:\n        event.preventDefault();\n        if (!nodeEditor.options('disableControls')) {\n            bubble.bubbling(nodeEditor);\n            cursor.restore(nodeEditor);\n        }\n        break;\n\n    case KEY.Comma:\n    case KEY.Semicolon:\n        event.preventDefault();\n        bubble.bubbling(nodeEditor);\n        cursor.restore(nodeEditor);\n        break;\n    }\n}\n\nfunction onKeydown(event) {\n    const code = events.keyCode(event);\n    const metaKey = events.metaKey(event);\n    const nodeEditor = event.currentTarget;\n    const enable = !nodeEditor.options('disableControls');\n\n    switch (code) {\n    case KEY.Esc:\n        event.preventDefault();\n        bubble.bubbling(nodeEditor);\n        cursor.restore(nodeEditor);\n        break;\n\n    case KEY.Backspace:\n        event.preventDefault();\n        backSpace(event);\n        break;\n\n    case KEY.Left:\n        event.preventDefault();\n        arrowLeft(event);\n        break;\n\n    //     \n    case KEY.Top:\n        event.preventDefault();\n        if (enable) {\n            const headBubble = bubbleset.headBubble(nodeEditor);\n            headBubble && select.uniq(headBubble);\n        }\n        break;\n\n    case KEY.Right:\n        event.preventDefault();\n        arrowRight(event);\n        break;\n\n    //     \n    // case KEY.Tab:\n    case KEY.Bottom:\n        event.preventDefault();\n        if (enable && select.has(nodeEditor)) {\n            cursor.restore(nodeEditor);\n        }\n        break;\n\n    case KEY.a:\n        if (metaKey) {\n            event.preventDefault();\n\n            if (!text.selectAll(null, event.currentTarget)) {\n                select.all(nodeEditor);\n            }\n        }\n        break;\n\n    case KEY.c:\n        if (metaKey) {\n            copy(nodeEditor);\n        }\n        break;\n    }\n}\n\nfunction arrowLeft(event) {\n    const selection = context.getSelection();\n\n    if (text.arrowLeft(selection, event.shiftKey)) {\n        return;\n    }\n\n    if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n        const nodeBubble = bubbleset.prevBubble(selection.anchorNode);\n        nodeBubble && select.uniq(nodeBubble);\n        return;\n    }\n\n    const nodeSet = event.currentTarget;\n    const list = select.get(nodeSet);\n    const begin = do {\n        if (list.length > 1 && list[ 0 ] === nodeSet.startRangeSelect) {\n            list[ list.length - 1 ];\n\n        } else {\n            list[ 0 ];\n        }\n    };\n\n    const node = bubbleset.prevBubble(begin);\n\n    if (node) {\n        if (event.shiftKey) {\n            select.range(node);\n\n        } else {\n            select.uniq(node);\n        }\n    }\n}\n\nfunction arrowRight(event) {\n    const selection = context.getSelection();\n\n    if (text.arrowRight(selection, event.shiftKey)) {\n        return;\n    }\n\n    if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n        const nodeBubble = bubbleset.nextBubble(selection.focusNode);\n        nodeBubble && select.uniq(nodeBubble);\n        return;\n    }\n\n    const nodeSet = event.currentTarget;\n    const list = select.get(nodeSet);\n    const begin = do {\n        if (list.length > 1 && list[ list.length - 1 ] === nodeSet.startRangeSelect) {\n            list[ 0 ];\n\n        } else {\n            list[ list.length - 1 ];\n        }\n    };\n\n    const node = bubbleset.nextBubble(begin);\n\n    if (node) {\n        if (event.shiftKey) {\n            select.range(node);\n\n        } else {\n            select.uniq(node);\n        }\n\n    } else if (begin && begin.nextSibling && begin.nextSibling.nodeType === Node.TEXT_NODE) {\n        select.clear(nodeSet);\n        selection.collapse(begin.nextSibling, 0);\n\n    } else {\n        cursor.restore(nodeSet);\n    }\n}\n\nfunction backSpace(event) {\n    const nodeSet = event.currentTarget;\n    nodeSet.normalize();\n\n    const selection = context.getSelection();\n    if (!selection) {\n        return;\n    }\n\n    if (selection.isCollapsed) {\n        if (text.arrowLeft(selection, true)) {\n            text.remove(selection);\n            nodeSet.fireInput();\n            return;\n        }\n\n    } else {\n        text.remove(selection);\n        nodeSet.fireInput();\n        return;\n    }\n\n    let node = bubbleset.findBubbleLeft(selection);\n    if (node) {\n        select.uniq(node);\n        return;\n    }\n\n    const list = select.get(nodeSet);\n\n    if (list.length) {\n        const prevBubble = list[ 0 ].previousSibling;\n        const nextBubble = list[ list.length - 1 ].nextSibling;\n        list.forEach(item => item.parentNode.removeChild(item));\n\n        if (bubble.isBubbleNode(prevBubble)) {\n            select.uniq(prevBubble);\n\n        } else if (bubble.isBubbleNode(nextBubble)) {\n            select.uniq(nextBubble);\n\n        } else {\n            nodeSet.focus();\n            cursor.restore(nodeSet);\n        }\n\n        nodeSet.fireChange();\n    }\n}\n\nfunction onPaste(event) {\n    event.preventDefault();\n    const nodeSet = event.currentTarget;\n\n    if (context.clipboardData && context.clipboardData.getData) {\n        text.replaceString(context.clipboardData.getData('Text'));\n        nodeSet.fireInput();\n\n    } else if (event.clipboardData) {\n        const contentType = 'text/plain';\n        const clipboardData = event.clipboardData;\n        let data = clipboardData.getData && clipboardData.getData(contentType);\n\n        if (text.replaceString(data)) {\n            nodeSet.fireInput();\n\n        } else if (clipboardData.items) {\n            Array.prototype.slice.call(clipboardData.items)\n                .filter(item => item.kind === 'string' && item.type === contentType)\n                .some(function (item) {\n                    item.getAsString(function (dataPaste) {\n                        text.replaceString(dataPaste);\n                        nodeSet.fireInput();\n                    });\n\n                    return true;\n                });\n        }\n    }\n}\n\nfunction onDblclick(event) {\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (nodeSet && nodeBubble) {\n        event.preventDefault();\n        bubble.edit(nodeSet, nodeBubble);\n    }\n}\n\nfunction onClick(event) {\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet) {\n        return;\n    }\n\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (nodeBubble) {\n        if (events.metaKey(event)) {\n            select.add(nodeBubble);\n\n        } else if (event.shiftKey) {\n            if (!nodeSet.startRangeSelect) {\n                select.uniq(nodeBubble);\n\n            } else {\n                select.range(nodeBubble);\n            }\n\n        } else {\n            select.toggleUniq(nodeBubble);\n        }\n\n    } else {\n        select.clear(nodeSet);\n\n        const selection = context.getSelection();\n\n        if (!selection ||\n            !selection.anchorNode ||\n            selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\n            cursor.restore(nodeSet);\n        }\n    }\n}\n\nfunction setContent(data) {\n    while (this.firstChild) {\n        this.removeChild(this.firstChild);\n    }\n\n    data = text.html2text(data);\n    this.appendChild(context.document.createTextNode(data));\n    bubble.bubbling(this);\n    cursor.restore(this);\n}\n\nfunction addBubble(bubbleText, data) {\n    const nodeBubble = bubble.create(this, bubbleText, data);\n    if (!nodeBubble) {\n        return false;\n    }\n\n    if (text.text2bubble(this, nodeBubble)) {\n        this.fireInput();\n        this.fireChange();\n        cursor.restore(this);\n        return true;\n    }\n\n    return false;\n}\n\nfunction removeBubble(nodeBubble) {\n    if (this.contains(nodeBubble)) {\n        this.removeChild(nodeBubble);\n        this.fireChange();\n        return true;\n    }\n\n    return false;\n}\n\nfunction editBubble(nodeBubble) {\n    if (this.contains(nodeBubble)) {\n        return bubble.edit(this, nodeBubble);\n    }\n\n    return false;\n}\n\nfunction fireEdit(nodeBubble) {\n    events.dispatch(this, EV.BUBBLE_EDIT, {\n        bubbles: false,\n        cancelable: false,\n        detail: { data: nodeBubble }\n    });\n}\n\nfunction fireChange() {\n    events.dispatch(this, EV.CHANGE, {\n        bubbles: false,\n        cancelable: false\n    });\n}\n\nfunction fireInput() {\n    const textRange = text.currentTextRange();\n    const editText = textRange && text.textClean(textRange.toString()) || '';\n\n    if (this._bubbleValue !== editText) {\n        this._bubbleValue = editText;\n\n        events.dispatch(this, EV.BUBBLE_INPUT, {\n            bubbles: false,\n            cancelable: false,\n            detail: { data: editText }\n        });\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editor.js\n **/","/**\n * @module x-bubbles/cursor\n */\n\nconst context = require('../context');\nconst text = require('./text');\nconst select = require('./select');\n\nexports.restore = restore;\nexports.restoreBasis = restoreBasis;\n\n/**\n * Reset the cursor position to the end of the input field.\n * @alias module:x-bubbles/cursor.restore\n * @param {HTMLElement} nodeSet\n */\nfunction restore(nodeSet) {\n    select.clear(nodeSet);\n    const basis = restoreBasis(nodeSet);\n    const selection = context.getSelection();\n    selection.removeAllRanges();\n    selection.collapse(basis, 1);\n}\n\n/**\n * The creation of the fake text at the end childNodes\n * @alias module:x-bubbles/cursor.restoreBasis\n * @param {HTMLElement} nodeSet\n * @returns {HTMLTextElement} fake text node\n */\nfunction restoreBasis(nodeSet) {\n    let fakeText = text.createZws();\n\n    if (nodeSet.hasChildNodes()) {\n        const lastNode = nodeSet.childNodes[ nodeSet.childNodes.length - 1 ];\n\n        if (lastNode.isEqualNode(fakeText)) {\n            fakeText = lastNode;\n\n        } else {\n            nodeSet.appendChild(fakeText);\n        }\n\n    } else {\n        nodeSet.appendChild(fakeText);\n    }\n\n    return fakeText;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/cursor.js\n **/","const events = require('../events');\nconst select = require('../select');\n\nmodule.exports = function (nodeSet) {\n    const selection = nodeSet.ownerDocument.defaultView.getSelection();\n    if (selection && selection.anchorNode) {\n        return;\n    }\n\n    const list = select.get(nodeSet);\n    if (!list.length) {\n        return;\n    }\n\n    const bubbleCopy = nodeSet.options('bubbleCopy');\n    const value = bubbleCopy(list);\n    if (!value) {\n        return;\n    }\n\n    nodeSet._lockCopy = true;\n\n    const target = nodeSet.ownerDocument.createElement('input');\n    target.value = value;\n    target.style.cssText = `\n        position: absolute;\n        top: -9999px;\n        width: 1px;\n        height: 1px;\n        margin: 0;\n        padding: 0;\n        border: none;`;\n\n    nodeSet.ownerDocument.body.appendChild(target);\n\n    events.one(target, {\n        blur: () => removeNode(target),\n        keyup: () => {\n            nodeSet.focus();\n            removeNode(target);\n        }\n    });\n\n    target.select();\n};\n\nfunction removeNode(node) {\n    node.parentNode && node.parentNode.removeChild(node);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editor/copy.js\n **/"],"sourceRoot":""}